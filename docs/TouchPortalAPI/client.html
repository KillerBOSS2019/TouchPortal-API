<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 12.0.1"/>
    <title>TouchPortalAPI.client API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css *//*! pygments syntax highlighting */pre{line-height:125%;}td.linenos pre{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}span.linenos{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}td.linenos pre.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}span.linenos.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}.pdoc .hll{background-color:#ffffcc}.pdoc{background:#f8f8f8;}.pdoc .c{color:#408080; font-style:italic}.pdoc .err{border:1px solid #FF0000}.pdoc .k{color:#008000; font-weight:bold}.pdoc .o{color:#666666}.pdoc .ch{color:#408080; font-style:italic}.pdoc .cm{color:#408080; font-style:italic}.pdoc .cp{color:#BC7A00}.pdoc .cpf{color:#408080; font-style:italic}.pdoc .c1{color:#408080; font-style:italic}.pdoc .cs{color:#408080; font-style:italic}.pdoc .gd{color:#A00000}.pdoc .ge{font-style:italic}.pdoc .gr{color:#FF0000}.pdoc .gh{color:#000080; font-weight:bold}.pdoc .gi{color:#00A000}.pdoc .go{color:#888888}.pdoc .gp{color:#000080; font-weight:bold}.pdoc .gs{font-weight:bold}.pdoc .gu{color:#800080; font-weight:bold}.pdoc .gt{color:#0044DD}.pdoc .kc{color:#008000; font-weight:bold}.pdoc .kd{color:#008000; font-weight:bold}.pdoc .kn{color:#008000; font-weight:bold}.pdoc .kp{color:#008000}.pdoc .kr{color:#008000; font-weight:bold}.pdoc .kt{color:#B00040}.pdoc .m{color:#666666}.pdoc .s{color:#BA2121}.pdoc .na{color:#7D9029}.pdoc .nb{color:#008000}.pdoc .nc{color:#0000FF; font-weight:bold}.pdoc .no{color:#880000}.pdoc .nd{color:#AA22FF}.pdoc .ni{color:#999999; font-weight:bold}.pdoc .ne{color:#D2413A; font-weight:bold}.pdoc .nf{color:#0000FF}.pdoc .nl{color:#A0A000}.pdoc .nn{color:#0000FF; font-weight:bold}.pdoc .nt{color:#008000; font-weight:bold}.pdoc .nv{color:#19177C}.pdoc .ow{color:#AA22FF; font-weight:bold}.pdoc .w{color:#bbbbbb}.pdoc .mb{color:#666666}.pdoc .mf{color:#666666}.pdoc .mh{color:#666666}.pdoc .mi{color:#666666}.pdoc .mo{color:#666666}.pdoc .sa{color:#BA2121}.pdoc .sb{color:#BA2121}.pdoc .sc{color:#BA2121}.pdoc .dl{color:#BA2121}.pdoc .sd{color:#BA2121; font-style:italic}.pdoc .s2{color:#BA2121}.pdoc .se{color:#BB6622; font-weight:bold}.pdoc .sh{color:#BA2121}.pdoc .si{color:#BB6688; font-weight:bold}.pdoc .sx{color:#008000}.pdoc .sr{color:#BB6688}.pdoc .s1{color:#BA2121}.pdoc .ss{color:#19177C}.pdoc .bp{color:#008000}.pdoc .fm{color:#0000FF}.pdoc .vc{color:#19177C}.pdoc .vg{color:#19177C}.pdoc .vi{color:#19177C}.pdoc .vm{color:#19177C}.pdoc .il{color:#666666}@media (prefers-color-scheme:dark){		.pdoc .hll{background-color:#49483e}	.pdoc{background:#272822; color:#f8f8f2}	.pdoc .c{color:#75715e}	.pdoc .err{color:#960050; background-color:#1e0010}	.pdoc .k{color:#66d9ef}	.pdoc .l{color:#ae81ff}	.pdoc .n{color:#f8f8f2}	.pdoc .o{color:#f92672}	.pdoc .p{color:#f8f8f2}	.pdoc .ch{color:#75715e}	.pdoc .cm{color:#75715e}	.pdoc .cp{color:#75715e}	.pdoc .cpf{color:#75715e}	.pdoc .c1{color:#75715e}	.pdoc .cs{color:#75715e}	.pdoc .gd{color:#f92672}	.pdoc .ge{font-style:italic}	.pdoc .gi{color:#a6e22e}	.pdoc .go{color:#66d9ef}	.pdoc .gp{color:#f92672; font-weight:bold}	.pdoc .gs{font-weight:bold}	.pdoc .gu{color:#75715e}	.pdoc .kc{color:#66d9ef}	.pdoc .kd{color:#66d9ef}	.pdoc .kn{color:#f92672}	.pdoc .kp{color:#66d9ef}	.pdoc .kr{color:#66d9ef}	.pdoc .kt{color:#66d9ef}	.pdoc .ld{color:#e6db74}	.pdoc .m{color:#ae81ff}	.pdoc .s{color:#e6db74}	.pdoc .na{color:#a6e22e}	.pdoc .nb{color:#f8f8f2}	.pdoc .nc{color:#a6e22e}	.pdoc .no{color:#66d9ef}	.pdoc .nd{color:#a6e22e}	.pdoc .ni{color:#f8f8f2}	.pdoc .ne{color:#a6e22e}	.pdoc .nf{color:#a6e22e}	.pdoc .nl{color:#f8f8f2}	.pdoc .nn{color:#f8f8f2}	.pdoc .nx{color:#a6e22e}	.pdoc .py{color:#f8f8f2}	.pdoc .nt{color:#f92672}	.pdoc .nv{color:#f8f8f2}	.pdoc .ow{color:#f92672}	.pdoc .w{color:#f8f8f2}	.pdoc .mb{color:#ae81ff}	.pdoc .mf{color:#ae81ff}	.pdoc .mh{color:#ae81ff}	.pdoc .mi{color:#ae81ff}	.pdoc .mo{color:#ae81ff}	.pdoc .sa{color:#e6db74}	.pdoc .sb{color:#e6db74}	.pdoc .sc{color:#e6db74}	.pdoc .dl{color:#e6db74}	.pdoc .sd{color:#e6db74}	.pdoc .s2{color:#e6db74}	.pdoc .se{color:#ae81ff}	.pdoc .sh{color:#e6db74}	.pdoc .si{color:#e6db74}	.pdoc .sx{color:#e6db74}	.pdoc .sr{color:#e6db74}	.pdoc .s1{color:#e6db74}	.pdoc .ss{color:#e6db74}	.pdoc .bp{color:#f8f8f2}	.pdoc .fm{color:#a6e22e}	.pdoc .vc{color:#f8f8f2}	.pdoc .vg{color:#f8f8f2}	.pdoc .vi{color:#f8f8f2}	.pdoc .vm{color:#f8f8f2}	.pdoc .il{color:#ae81ff}}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>@media (prefers-color-scheme:dark){:root{--pdoc-background:#212529;}.pdoc{--text:#f7f7f7;--muted:#9d9d9d;--link:#58a6ff;--link-hover:#3989ff;--code:#333;--active:#555;--accent:#343434;--accent2:#555;--nav-hover:rgba(0, 0, 0, 0.1);--name:#77C1FF;--def:#0cdd0c;--annotation:#00c037;}}
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>.version_header{font-size:.75rem;float:right;margin-top:-3em;margin-right:4em;}nav.pdoc a.inline{display:inline-block;}.module-list-button:not([href$='.html']){display:none !important;}@media (min-width:770px){main, header{width:auto !important;}}@media (max-width:769px){#navtoggle{top:.5rem !important;right:3rem !important;}nav.pdoc input[type=search]{width:calc(100% - 70px - 3rem);}.version_header{float:left;margin-top:-2em;}}
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>.pdoc .attribution{font-size:small;}.pdoc .attribution img{height:25px; width:auto;}
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../TouchPortalAPI.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;TouchPortalAPI</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#Client">Client</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Client.__init__">Client</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.TPHOST">TPHOST</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.TPPORT">TPPORT</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.RCV_BUFFER_SZ">RCV_BUFFER_SZ</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.SND_BUFFER_SZ">SND_BUFFER_SZ</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.SOCK_EVENT_TO">SOCK_EVENT_TO</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.isConnected">isConnected</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.isActionBeingHeld">isActionBeingHeld</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.createState">createState</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.createStateMany">createStateMany</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.removeState">removeState</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.removeStateMany">removeStateMany</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.choiceUpdate">choiceUpdate</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.choiceUpdateSpecific">choiceUpdateSpecific</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.settingUpdate">settingUpdate</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.stateUpdate">stateUpdate</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.stateUpdateMany">stateUpdateMany</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.showNotification">showNotification</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.shortIdUpdate">shortIdUpdate</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.connectorUpdate">connectorUpdate</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.updateActionData">updateActionData</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.getChoiceUpdatelist">getChoiceUpdatelist</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.getStatelist">getStatelist</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.getSettinghistory">getSettinghistory</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.send">send</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.connect">connect</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.disconnect">disconnect</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.getActionDataValue">getActionDataValue</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TYPES">TYPES</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TYPES.__init__">TYPES</a>
                        </li>
                        <li>
                                <a class="variable" href="#TYPES.onHold_up">onHold_up</a>
                        </li>
                        <li>
                                <a class="variable" href="#TYPES.onHold_down">onHold_down</a>
                        </li>
                        <li>
                                <a class="variable" href="#TYPES.onConnect">onConnect</a>
                        </li>
                        <li>
                                <a class="variable" href="#TYPES.onAction">onAction</a>
                        </li>
                        <li>
                                <a class="variable" href="#TYPES.onListChange">onListChange</a>
                        </li>
                        <li>
                                <a class="variable" href="#TYPES.onConnectorChange">onConnectorChange</a>
                        </li>
                        <li>
                                <a class="variable" href="#TYPES.onShutdown">onShutdown</a>
                        </li>
                        <li>
                                <a class="variable" href="#TYPES.onBroadcast">onBroadcast</a>
                        </li>
                        <li>
                                <a class="variable" href="#TYPES.onSettingUpdate">onSettingUpdate</a>
                        </li>
                        <li>
                                <a class="variable" href="#TYPES.onNotificationOptionClicked">onNotificationOptionClicked</a>
                        </li>
                        <li>
                                <a class="variable" href="#TYPES.shortConnectorIdNotification">shortConnectorIdNotification</a>
                        </li>
                        <li>
                                <a class="variable" href="#TYPES.allMessage">allMessage</a>
                        </li>
                        <li>
                                <a class="variable" href="#TYPES.onError">onError</a>
                        </li>
                </ul>

            </li>
    </ul>


    <footer>Documentation for TouchPortalAPI v1.6.3<br/>generated: 2022-06-05 05:42 UTC<br/>git version: <a href='https://github.com/KillerBOSS2019/TouchPortal-API/commit/93915690' class='inline' target='_blank'>1.6.3-12-g93915690</a><br/></footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
        <div class="version_header">TouchPortalAPI v1.6.3</div>
<a href="https://github.com/KillerBOSS2019/TouchPortal-API/blob/main/TouchPortalAPI/client.py" target="_blank" class="github-corner" title="View the latest source on GitHub" aria-label="View source on GitHub">
    <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#3bb300; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true" class="corner-svg">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
<style>
    .corner-svg {
        width: 80px;
        height: 80px;
    }
    .github-corner:hover .octo-arm { animation: octocat-wave 560ms ease-in-out }
    @keyframes octocat-wave {
        0%, 100% { transform: rotate(0) }
        20%, 60% { transform: rotate(-25deg) }
        40%, 80% { transform: rotate(10deg) }
    }
    @media (max-width: 769px) {
        .corner-svg {
            width: 50px;
            height: 50px;
        }
    }
</style>                    <h1 class="modulename">
<a href="./../TouchPortalAPI.html">TouchPortalAPI</a><wbr>.client    </h1>

                
                        <input id="client-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="client-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="n">__copyright__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="s2">    This file is part of the TouchPortal-API project.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="s2">    Copyright (C) 2021 DamienS</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="s2">    This program is free software: you can redistribute it and/or modify</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="s2">    it under the terms of the GNU General Public License as published by</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="s2">    the Free Software Foundation, either version 3 of the License, or</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="s2">    (at your option) any later version.</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="s2">    This program is distributed in the hope that it will be useful,</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="s2">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="s2">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="s2">    GNU General Public License for more details.</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="s2">    You should have received a copy of the GNU General Public License</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="s2">    along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">import</span> <span class="nn">socket</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="kn">import</span> <span class="nn">selectors</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">import</span> <span class="nn">json</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="kn">from</span> <span class="nn">pyee</span> <span class="kn">import</span> <span class="n">ExecutorEventEmitter</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="kn">from</span> <span class="nn">concurrent.futures</span> <span class="kn">import</span> <span class="n">Executor</span><span class="p">,</span> <span class="n">ThreadPoolExecutor</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Event</span><span class="p">,</span> <span class="n">Lock</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="kn">from</span> <span class="nn">.tools</span> <span class="kn">import</span> <span class="n">Tools</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Client&#39;</span><span class="p">,</span> <span class="s1">&#39;TYPES&#39;</span><span class="p">]</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="k">class</span> <span class="nc">TYPES</span><span class="p">:</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">    Event type enumerations. These correspond to the message types Touch Portal may send.</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">    Event handler callbacks receive one parameter, which is the JSON data structure sent</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">    from TP and then converted to a corresponding Python object using `json.loads()`.</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">    Usage example:</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">        ```py</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">        import TouchPortalAPI as TP</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">        client = TP.Client(&quot;myplugin&quot;)</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">        @client.on(TP.TYPES.onConnect)</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">        # equivalent to: @client.on(&#39;info&#39;)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">        def onConnect(data):</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">            print(data)</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">        # alternatively, w/out decorators:</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">        def onAction(data):</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">            print(data)</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">        client.on(TP.TYPES.onAction, onAction)</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">        ```</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>    <span class="n">onHold_up</span> <span class="o">=</span> <span class="s1">&#39;up&#39;</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>    <span class="sd">&quot;&quot;&quot; When the action is used in a hold functionality and the user releases the Touch Portal button (Api 3.0+) &quot;&quot;&quot;</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>    <span class="n">onHold_down</span> <span class="o">=</span> <span class="s1">&#39;down&#39;</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>    <span class="sd">&quot;&quot;&quot; When the action is used in a hold functionality and the user presses the Touch Portal button down (Api 3.0+) &quot;&quot;&quot;</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>    <span class="n">onConnect</span> <span class="o">=</span> <span class="s1">&#39;info&#39;</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>    <span class="sd">&quot;&quot;&quot; Info message returned after successful pairing. &quot;&quot;&quot;</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>    <span class="n">onAction</span> <span class="o">=</span> <span class="s1">&#39;action&#39;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>    <span class="sd">&quot;&quot;&quot; When actions are triggered by the user (Api 1.0+) &quot;&quot;&quot;</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>    <span class="n">onListChange</span> <span class="o">=</span> <span class="s1">&#39;listChange&#39;</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>    <span class="sd">&quot;&quot;&quot; When a user makes a change in one of your lists (Api 1.0+) &quot;&quot;&quot;</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>    <span class="n">onConnectorChange</span> <span class="o">=</span> <span class="s1">&#39;connectorChange&#39;</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>    <span class="sd">&quot;&quot;&quot; When a connector is used in a slider functionality (connector) (Api 4.0+) &quot;&quot;&quot;</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>    <span class="n">onShutdown</span> <span class="o">=</span> <span class="s1">&#39;closePlugin&#39;</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>    <span class="sd">&quot;&quot;&quot; When Touch Portal tries to close your plug-in (Api 2.0+) &quot;&quot;&quot;</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>    <span class="n">onBroadcast</span> <span class="o">=</span> <span class="s1">&#39;broadcast&#39;</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>    <span class="sd">&quot;&quot;&quot; When Touch Portal broadcasts a message (Api 3.0+) &quot;&quot;&quot;</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>    <span class="n">onSettingUpdate</span> <span class="o">=</span> <span class="s1">&#39;settings&#39;</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>    <span class="sd">&quot;&quot;&quot; When the plugin&#39;s Settings have been updated (by user or from the plugin itself) (Api 3.0+) &quot;&quot;&quot;</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>    <span class="n">onNotificationOptionClicked</span> <span class="o">=</span> <span class="s2">&quot;notificationOptionClicked&quot;</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>    <span class="sd">&quot;&quot;&quot; When a user clicks on a notification action (Api 4.0+) &quot;&quot;&quot;</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>    <span class="n">shortConnectorIdNotification</span> <span class="o">=</span> <span class="s1">&#39;shortConnectorIdNotification&#39;</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>    <span class="sd">&quot;&quot;&quot; When creating new connector for the first time It will generate shortid and It will send as an event (Api 5.0+) &quot;&quot;&quot;</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>    <span class="n">allMessage</span> <span class="o">=</span> <span class="s1">&#39;any&#39;</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>    <span class="sd">&quot;&quot;&quot; Special event handler which will receive **all** messages from TouchPortal. &quot;&quot;&quot;</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>    <span class="n">onError</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>    <span class="sd">&quot;&quot;&quot; Special event emitted when any other event callback raises an exception.</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">        For this particular event, the parameter passed to the callback handler will be an `Exception` object.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">        See also `pyee.ExecutorEventEmitter.error` event.</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="k">class</span> <span class="nc">Client</span><span class="p">(</span><span class="n">ExecutorEventEmitter</span><span class="p">):</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">    A TCP/IP client for [Touch Portal API](https://www.touch-portal.com/api) plugin integration.</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">    Implements a [pyee.ExecutorEventEmitter](https://pyee.readthedocs.io/en/latest/#pyee.ExecutorEventEmitter).</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">    After an initial connection to a Touch Portal desktop application &quot;server,&quot; the client</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">    implements a send/receive event loop while maintaining the open sockets. Messages between</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">    TP and the plugin are exchanged asynchronously, with all sending methods possibly returning</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">    before the actual data is sent.</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">    Messages from Touch Portal are delivered to the plugin script via event handler callbacks,</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">    which can be either individual callbacks per message type, and/or a single handler for all</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">    types of messages. The callbacks are executed in separate Thread(s), using a pool of up to</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">    any number of concurrent threads as needed (if using more than one thread, the plugin</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">    code itself is responsible for thread safety of its internal data). Please check the</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">    `pyee.EventEmitter` documentation for general information on how events are handled</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">    (which can be either via function decorators or via the inherited `Client.on()` method).</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">    Generated event names correspond to Touch Portal API message types, one for each type</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">    as defined in the TP API documentation (eg. &quot;action&quot; or &quot;listChange&quot;) as well as one event</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">    which is generated for all message types (&quot;any&quot;). Alternately, for a more formal approach,</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">    the corresponding members of the `TYPES` class could be used instead of string names</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">    (eg. `TYPES.onAction` or `TYPES.onListChange`).</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">    Any errors raised within event listeners/handlers are trapped and then reported in the</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">    inherited &quot;error&quot; event (from pyee.ExecutorEventEmitter), aka `TYPES.onError`.</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>    <span class="n">TPHOST</span> <span class="o">=</span> <span class="s1">&#39;127.0.0.1&#39;</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>    <span class="sd">&quot;&quot;&quot; TP plugin server host IPv4 address. &quot;&quot;&quot;</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>    <span class="n">TPPORT</span> <span class="o">=</span> <span class="mi">12136</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>    <span class="sd">&quot;&quot;&quot; TP plugin server host IPv4 port number. &quot;&quot;&quot;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>    <span class="n">RCV_BUFFER_SZ</span> <span class="o">=</span> <span class="mi">4096</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>    <span class="sd">&quot;&quot;&quot; [B] incoming data buffer size. &quot;&quot;&quot;</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>    <span class="n">SND_BUFFER_SZ</span> <span class="o">=</span> <span class="mi">32</span><span class="o">**</span><span class="mi">4</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>    <span class="sd">&quot;&quot;&quot; [B] maximum size of send data buffer (1MB). &quot;&quot;&quot;</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>    <span class="n">SOCK_EVENT_TO</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>    <span class="sd">&quot;&quot;&quot; [s] maximum wait time for socket events (blocking timeout for selector.select()). &quot;&quot;&quot;</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pluginId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>                 <span class="n">sleepPeriod</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>                 <span class="n">autoClose</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>                 <span class="n">checkPluginId</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>                 <span class="n">updateStatesOnBroadcast</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>                 <span class="n">maxWorkers</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>                 <span class="n">executor</span><span class="p">:</span><span class="n">Executor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>                 <span class="n">useNamespaceCallbacks</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">        Creates an instance of the client.</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">        Args:</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">            `pluginId`: ID string of the TouchPortal plugin using this client. **Required.**</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">            `sleepPeriod`: Seconds to sleep the event loop between socket read events. Default: 0.01</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">            `autoClose`: If `True` then this client will automatically disconnect when a `closePlugin` message is received from TP.</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">                Default is `False`.</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">            `checkPluginId`: Validate that `pluginId` matches ours in any messages from TP which contain one (such as actions).</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a><span class="sd">                Default is `True`.</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">            `updateStatesOnBroadcast`: Re-send all cached State values whenever user switches TP page.</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">                Default is `True`.</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">            `maxWorkers`: Maximum worker threads to run concurrently for event handlers.</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">                Default of `None` creates a default-constructed `ThreadPoolExecutor`.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">            `executor`: Passed to `pyee.ExecutorEventEmitter`. By default this is a default-constructed</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">                [ThreadPoolExecutor](https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.ThreadPoolExecutor),</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">                optionally using `maxWorkers` concurrent threads.</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">            `useNamespaceCallbacks`: use NamespaceCallback as message handler</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">                Default is `False` meaning It will send normal json</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">                `True` meaning It will automatically convert json to namespace to make easier access value </span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">                eg json: data[&#39;actionId&#39;][&#39;value&#39;] and namespace would be data.actionId.value</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">executor</span> <span class="ow">and</span> <span class="n">maxWorkers</span><span class="p">:</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>            <span class="n">executor</span> <span class="o">=</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">maxWorkers</span><span class="p">)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Client</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">executor</span><span class="o">=</span><span class="n">executor</span><span class="p">)</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pluginId</span> <span class="o">=</span> <span class="n">pluginId</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sleepPeriod</span> <span class="o">=</span> <span class="n">sleepPeriod</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">autoClose</span> <span class="o">=</span> <span class="n">autoClose</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkPluginId</span> <span class="o">=</span> <span class="n">checkPluginId</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">updateStatesOnBroadcast</span> <span class="o">=</span> <span class="n">updateStatesOnBroadcast</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">useNamespaceCallbacks</span> <span class="o">=</span> <span class="n">useNamespaceCallbacks</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">currentSettings</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">choiceUpdateList</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shortIdTracker</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__heldActions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>       <span class="c1"># main loop inerrupt</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>           <span class="c1"># not running yet</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__dataReadyEvent</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>  <span class="c1"># set when __sendBuffer has data</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>        <span class="c1"># mutex for __sendBuffer</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__recvBuffer</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>            
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>    <span class="k">def</span> <span class="nf">__buffered_readLine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>            <span class="c1"># Should be ready to read</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RCV_BUFFER_SZ</span><span class="p">)</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>        <span class="k">except</span> <span class="ne">BlockingIOError</span><span class="p">:</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>            <span class="k">pass</span>  <span class="c1"># Resource temporarily unavailable (errno EWOULDBLOCK)</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>            <span class="k">raise</span>  <span class="c1"># No connection</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>            <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>                <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__recvBuffer</span> <span class="o">+=</span> <span class="n">data</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>                <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recvBuffer</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__recvBuffer</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recvBuffer</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>                <span class="k">return</span> <span class="n">lines</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>                <span class="c1"># No connection</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Peer closed the connection.&quot;</span><span class="p">)</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>    <span class="k">def</span> <span class="nf">__write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getWriteLock</span><span class="p">():</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>                <span class="c1"># Should be ready to write</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>                <span class="n">sent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span><span class="p">)</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>            <span class="k">except</span> <span class="ne">BlockingIOError</span><span class="p">:</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>                <span class="k">pass</span>  <span class="c1"># Resource temporarily unavailable (errno EWOULDBLOCK)</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>                <span class="k">raise</span>  <span class="c1"># No connection</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span><span class="p">[:</span><span class="n">sent</span><span class="p">]</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>            <span class="k">finally</span><span class="p">:</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span><span class="p">:</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__dataReadyEvent</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>    <span class="k">def</span> <span class="nf">__run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>            <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>                <span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">SOCK_EVENT_TO</span><span class="p">)</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>  <span class="c1"># may be set while waiting for selector events (unlikely)</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>                    <span class="k">break</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">mask</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="n">selectors</span><span class="o">.</span><span class="n">EVENT_READ</span><span class="p">):</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>                        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__buffered_readLine</span><span class="p">():</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">__processMessage</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="n">selectors</span><span class="o">.</span><span class="n">EVENT_WRITE</span><span class="p">):</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">__write</span><span class="p">()</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>                <span class="c1"># Sleep for period or until there is data in the write buffer.</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>                <span class="c1"># In theory if data is constantly avaiable, this could block,</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>                <span class="c1"># in which case it may be better to self.__stopEvent.wait()</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataReadyEvent</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sleepPeriod</span><span class="p">):</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>                    <span class="k">continue</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>                <span class="k">continue</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__die</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception in client event loop: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>    <span class="k">def</span> <span class="nf">__processMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">and</span> <span class="p">(</span><span class="n">act_type</span> <span class="o">:=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)):</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkPluginId</span> <span class="ow">and</span> <span class="p">(</span><span class="n">pid</span> <span class="o">:=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pluginId&#39;</span><span class="p">))</span> <span class="ow">and</span> <span class="n">pid</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pluginId</span><span class="p">:</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>                <span class="k">return</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>            <span class="k">if</span> <span class="n">act_type</span> <span class="o">==</span> <span class="n">TYPES</span><span class="o">.</span><span class="n">onShutdown</span><span class="p">:</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">autoClose</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__close</span><span class="p">()</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>            <span class="k">elif</span> <span class="n">act_type</span> <span class="o">==</span> <span class="n">TYPES</span><span class="o">.</span><span class="n">onHold_down</span> <span class="ow">and</span> <span class="p">(</span><span class="n">aid</span> <span class="o">:=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;actionId&#39;</span><span class="p">)):</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__heldActions</span><span class="p">[</span><span class="n">aid</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>            <span class="k">elif</span> <span class="n">act_type</span> <span class="o">==</span> <span class="n">TYPES</span><span class="o">.</span><span class="n">onHold_up</span> <span class="ow">and</span> <span class="p">(</span><span class="n">aid</span> <span class="o">:=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;actionId&#39;</span><span class="p">)):</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__heldActions</span><span class="p">[</span><span class="n">aid</span><span class="p">]</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>            <span class="k">elif</span> <span class="n">act_type</span> <span class="o">==</span> <span class="n">TYPES</span><span class="o">.</span><span class="n">onBroadcast</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">updateStatesOnBroadcast</span><span class="p">:</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__stateUpdate</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>            <span class="k">elif</span> <span class="n">act_type</span> <span class="o">==</span> <span class="n">TYPES</span><span class="o">.</span><span class="n">shortConnectorIdNotification</span><span class="p">:</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">shortIdTracker</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;connectorId&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;shortId&#39;</span><span class="p">]</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__emitEvent</span><span class="p">(</span><span class="n">act_type</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>    <span class="k">def</span> <span class="nf">__emitEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">useNamespaceCallbacks</span><span class="p">:</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">ev</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">TYPES</span><span class="o">.</span><span class="n">allMessage</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>            <span class="n">convertedData</span> <span class="o">=</span> <span class="n">Tools</span><span class="o">.</span><span class="n">nested_conversion</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1"># No need to call this twice</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">ev</span><span class="p">,</span> <span class="n">convertedData</span><span class="p">)</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">TYPES</span><span class="o">.</span><span class="n">allMessage</span><span class="p">,</span> <span class="n">convertedData</span><span class="p">)</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>    <span class="k">def</span> <span class="nf">__open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">selector</span> <span class="o">=</span> <span class="n">selectors</span><span class="o">.</span><span class="n">DefaultSelector</span><span class="p">()</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">TPHOST</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TPPORT</span><span class="p">))</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">selector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>            <span class="k">raise</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">setblocking</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="p">(</span><span class="n">selectors</span><span class="o">.</span><span class="n">EVENT_READ</span> <span class="o">|</span> <span class="n">selectors</span><span class="o">.</span><span class="n">EVENT_WRITE</span><span class="p">))</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>    <span class="k">def</span> <span class="nf">__close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">locked</span><span class="p">():</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="p">:</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>            <span class="k">return</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">get_map</span><span class="p">():</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">)</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in selector.unregister(): </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SHUT_RDWR</span><span class="p">)</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in socket.close(): </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="k">finally</span><span class="p">:</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>            <span class="c1"># Delete reference to socket object for garbage collection, socket cannot be reused anyway.</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>        <span class="c1"># print(&quot;TP Client stopped.&quot;)</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>    <span class="k">def</span> <span class="nf">__die</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__emitEvent</span><span class="p">(</span><span class="n">TYPES</span><span class="o">.</span><span class="n">onShutdown</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">TYPES</span><span class="o">.</span><span class="n">onShutdown</span><span class="p">})</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__close</span><span class="p">()</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        <span class="k">if</span> <span class="n">exc</span><span class="p">:</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>            <span class="k">raise</span> <span class="n">exc</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>    <span class="k">def</span> <span class="nf">__getWriteLock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">15</span><span class="p">):</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">locked</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__die</span><span class="p">(</span><span class="n">exc</span><span class="o">=</span><span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Send buffer mutex deadlock, cannot continue.&quot;</span><span class="p">))</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>    <span class="k">def</span> <span class="nf">isConnected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a><span class="sd">        Returns `True` if the Client is connected to Touch Portal, `False` otherwise.</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>    <span class="k">def</span> <span class="nf">isActionBeingHeld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actionId</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="sd">        For an Action with ID of `actionId` that can be held (`hasHoldFunctionality` is true),</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="sd">        this method returns `True` while it is being held and `False` otherwise.</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>        <span class="k">return</span> <span class="n">actionId</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__heldActions</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>    <span class="k">def</span> <span class="nf">createState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">parentGroup</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a><span class="sd">        This will create a TP State at runtime. `stateId`, `description`, and `value` (`value` becomes the State&#39;s default value) are all required except `parentGroup` which allow you to create states in a `folder`.</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>        <span class="k">if</span> <span class="n">stateId</span> <span class="ow">and</span> <span class="n">description</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>            <span class="k">if</span> <span class="n">stateId</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="p">:</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;createState&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">stateId</span><span class="p">,</span> <span class="s2">&quot;desc&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span> <span class="s2">&quot;defaultValue&quot;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span> <span class="s2">&quot;parentGroup&quot;</span><span class="p">:</span> <span class="n">parentGroup</span><span class="p">})</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="p">[</span><span class="n">stateId</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stateUpdate</span><span class="p">(</span><span class="n">stateId</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>    <span class="k">def</span> <span class="nf">createStateMany</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a><span class="sd">        Convenience function to create several States at once. `states` should be an iteratable of `dict` types</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a><span class="sd">        in the form of `{&#39;id&#39;: &quot;StateId&quot;, &#39;desc&#39;: &quot;Description&quot;, &#39;value&#39;: &quot;Default Value&quot;}` and optionally `&#39;parentGroup&#39;: &quot;Value&quot;` which will make state `folder`.</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">createState</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;parentGroup&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;createStateMany() requires a list of dicts, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="si">}</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;createStateMany() requires an iteratable, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="si">}</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>    <span class="k">def</span> <span class="nf">removeState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">validateExists</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a><span class="sd">        This removes a State that has been created at runtime. `stateId` is the ID to remove.</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a><span class="sd">        If `validateExists` is True (default) this method will raise an Exception if the `stateId`</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a><span class="sd">        does not exist in the current state cache.</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>        <span class="k">if</span> <span class="n">stateId</span> <span class="ow">and</span> <span class="n">stateId</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="p">:</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;removeState&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">stateId</span><span class="p">})</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">stateId</span><span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>        <span class="k">elif</span> <span class="n">validateExists</span><span class="p">:</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stateId</span><span class="si">}</span><span class="s2"> Does not exist.&quot;</span><span class="p">)</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>    <span class="k">def</span> <span class="nf">removeStateMany</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a><span class="sd">        Convenience function to remove several States at once. `states` should be an iteratable of state ID strings.</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="sd">        This method does not validate if the states exist in the current state cache. See also: `removeState`.</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">removeState</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;removeStateMany() requires an iteratable, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="si">}</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>    <span class="k">def</span> <span class="nf">choiceUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">choiceId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="sd">        This updates the list of choices in a previously-declared TP State with id `stateId`.</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="sd">        See TP API reference for details on updating list values.</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>        <span class="k">if</span> <span class="n">choiceId</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;choiceUpdate&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">choiceId</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">})</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">choiceUpdateList</span><span class="p">[</span><span class="n">choiceId</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;choiceUpdate() values argument needs to be a list not a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>    <span class="k">def</span> <span class="nf">choiceUpdateSpecific</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">instanceId</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">        This updates a list of choices in a specific TP Item Instance, specified in `instanceId`.</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="sd">        See TP API reference for details on updating specific instances.</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>        <span class="k">if</span> <span class="n">stateId</span> <span class="ow">and</span> <span class="n">instanceId</span><span class="p">:</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;choiceUpdate&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">stateId</span><span class="p">,</span> <span class="s2">&quot;instanceId&quot;</span><span class="p">:</span> <span class="n">instanceId</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">})</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;choiceUpdateSpecific() values argument needs to be a list not a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>    <span class="k">def</span> <span class="nf">settingUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settingName</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">settingValue</span><span class="p">):</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a><span class="sd">        This updates a value named `settingName` in your plugin&#39;s Settings to `settingValue`.</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>        <span class="k">if</span> <span class="n">settingName</span> <span class="ow">and</span> <span class="n">settingName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentSettings</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentSettings</span><span class="p">[</span><span class="n">settingName</span><span class="p">]</span> <span class="o">!=</span> <span class="n">settingValue</span><span class="p">:</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;settingUpdate&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">settingName</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">settingValue</span><span class="p">})</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">currentSettings</span><span class="p">[</span><span class="n">settingName</span><span class="p">]</span> <span class="o">=</span> <span class="n">settingValue</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>    <span class="k">def</span> <span class="nf">stateUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">stateValue</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="sd">        This updates a value in ether a pre-defined static State or a dynamic State created in runtime.</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__stateUpdate</span><span class="p">(</span><span class="n">stateId</span><span class="p">,</span> <span class="n">stateValue</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>    <span class="k">def</span> <span class="nf">__stateUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">stateValue</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">forced</span><span class="p">:</span><span class="nb">bool</span><span class="p">):</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>        <span class="k">if</span> <span class="n">stateId</span><span class="p">:</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>            <span class="k">if</span> <span class="n">forced</span> <span class="ow">or</span> <span class="n">stateId</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="p">[</span><span class="n">stateId</span><span class="p">]</span> <span class="o">!=</span> <span class="n">stateValue</span><span class="p">:</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;stateUpdate&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">stateId</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">stateValue</span><span class="p">})</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="p">[</span><span class="n">stateId</span><span class="p">]</span> <span class="o">=</span> <span class="n">stateValue</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>    <span class="k">def</span> <span class="nf">stateUpdateMany</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a><span class="sd">        Convenience function to update several states at once.</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a><span class="sd">        `states` should be an iteratable of `dict` types in the form of `{&#39;id&#39;: &quot;StateId&quot;, &#39;value&#39;: &quot;The New Value&quot;}`.</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stateUpdate</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;StateUpdateMany() requires a list of dicts, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="si">}</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;StateUpdateMany() requires an iteratable, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="si">}</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>    <span class="k">def</span> <span class="nf">showNotification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">notificationId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a><span class="sd">        This method allows your plugin to send a notification to Touch Portal with custom title, message body and available user action(s).</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a><span class="sd">        Requires TP SDK v4.0 or higher.</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a><span class="sd">        Args:</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a><span class="sd">            `notificationId`: Unique ID of this notification.</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a><span class="sd">            `title`: The notification title.</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a><span class="sd">            `msg`: The message body text that is shown in the notifcation.</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a><span class="sd">            `options`: List of options (actions) for the notification. Each option should be a `dict` type with `id` and `title` keys.</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>        <span class="k">if</span> <span class="n">notificationId</span> <span class="ow">and</span> <span class="n">title</span> <span class="ow">and</span> <span class="n">msg</span> <span class="ow">and</span> <span class="n">options</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>            <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>                <span class="k">if</span> <span class="s1">&#39;id&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">option</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;title&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">option</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;all options require id and title keys&quot;</span><span class="p">)</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;showNotification&quot;</span><span class="p">,</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>                <span class="s2">&quot;notificationId&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">notificationId</span><span class="p">),</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>                <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">),</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>                <span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>                <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="n">options</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>            <span class="p">})</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>    <span class="k">def</span> <span class="nf">shortIdUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shortId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">connectorValue</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a><span class="sd">        This allows you to update slider position value using shortId which TouchPortal will broadcast.</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a><span class="sd">        Args:</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a><span class="sd">            `shortId`: a shortId is a id that is mapped to connectorId by TouchPortal</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a><span class="sd">            `connectorValue`: A integer between 0-100</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">connectorValue</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">:</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;connectorUpdate&quot;</span><span class="p">,</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>                <span class="s2">&quot;shortId&quot;</span><span class="p">:</span> <span class="n">shortId</span><span class="p">,</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">connectorValue</span><span class="p">)</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>            <span class="p">})</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>    <span class="k">def</span> <span class="nf">connectorUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connectorId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">connectorValue</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a><span class="sd">        This allows you to update slider position value.</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a><span class="sd">        Args:</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a><span class="sd">            `connectorId`: Cannot be longer then 200 characters.</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a><span class="sd">                connectorId have syntax that you need to follow https://www.touch-portal.com/api/index.php?section=connectors</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a><span class="sd">                Also according to that site It requires you to have prefix &quot;pc_yourPluginId_&quot; + connectorid however This already provide</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a><span class="sd">                you the prefix and the pluginId so you just need you take care the rest eg connectorid|setting1=aValue</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a><span class="sd">            `connectorValue`: Must be an integer between 0-100.</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a><span class="sd">        Note: This method will automatically looking for shortId using gaven connectorId however if It cannot find shortId it will just send connectorId</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">connectorId</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;connectorId needs to be a str not a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">connectorId</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">connectorValue</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;connectorValue requires a int not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">connectorValue</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">connectorValue</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">:</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">cid</span> <span class="o">:=</span> <span class="sa">f</span><span class="s2">&quot;pc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pluginId</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">connectorId</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shortIdTracker</span><span class="p">:</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">shortIdUpdate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shortIdTracker</span><span class="p">[</span><span class="n">cid</span><span class="p">],</span> <span class="n">connectorValue</span><span class="p">)</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;connectorUpdate&quot;</span><span class="p">,</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>                    <span class="s2">&quot;connectorId&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;pc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pluginId</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">connectorId</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>                    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">connectorValue</span><span class="p">)</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>                <span class="p">})</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;connectorValue needs to be between 0-100 not </span><span class="si">{</span><span class="n">connectorValue</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>    <span class="k">def</span> <span class="nf">updateActionData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instanceId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">minValue</span><span class="p">,</span> <span class="n">maxValue</span><span class="p">):</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a><span class="sd">        This allows you to update Action Data in one of your Action. Currently TouchPortal only supports changing the minimum and maximum values in numeric data types.</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;updateActionData&quot;</span><span class="p">,</span> <span class="s2">&quot;instanceId&quot;</span><span class="p">:</span> <span class="n">instanceId</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;minValue&quot;</span><span class="p">:</span> <span class="n">minValue</span><span class="p">,</span> <span class="s2">&quot;maxValue&quot;</span><span class="p">:</span> <span class="n">maxValue</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">stateId</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">}})</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>    <span class="k">def</span> <span class="nf">getChoiceUpdatelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">        This will return a dict that `choiceUpdate` registered.</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">            example return value `{&quot;choiceUpdateid1&quot;: [&quot;item1&quot;, &quot;item2&quot;, &quot;item3&quot;], &quot;exampleChoiceId&quot;: [&quot;Option1&quot;, &quot;Option2&quot;, &quot;Option3&quot;]}`</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a><span class="sd">        You should use this to verify before Updating the choice list    </span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a><span class="sd">        **Note** This is the same as TPClient.choiceUpdateList variable *DO NOT MODIFY* TPClient.choiceUpdateList unless you know what your doing</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">choiceUpdateList</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>    <span class="k">def</span> <span class="nf">getStatelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a><span class="sd">        This will return a dict that have key pair of states that you last updated.</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a><span class="sd">            Example retun value `{&quot;stateId1&quot;: &quot;value1&quot;, &quot;stateId2&quot;: &quot;value2&quot;, &quot;stateId3&quot;: &quot;value3&quot;}`</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a><span class="sd">        This is used to keep track of all states. It will be automatically updated when you update states</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a><span class="sd">        **Note** This is the same as TPClient.currentState variable *DO NOT MODIFY* TPClient.currentState unless you know what your doing</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>    <span class="k">def</span> <span class="nf">getSettinghistory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a><span class="sd">        This will return a dict that have key pair of setting value that you updated previously.</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a><span class="sd">        This is used to track settings value that you have updated previously </span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a><span class="sd">        **Note** This is the same as TPClient.currentSettings variable *DO NOT MODIFY* TPClient.currentSettings unless you know what your doing</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentSettings</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a><span class="sd">        This will try to send any arbitrary Python object in `data` (presumably something `dict`-like) to Touch Portal</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a><span class="sd">        after serializing it as JSON and adding a `\n`. Normally there is no need to use this method directly, but if the</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a><span class="sd">        Python API doesn&#39;t cover something from the TP API, this could be used instead.</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getWriteLock</span><span class="p">():</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SND_BUFFER_SZ</span><span class="p">:</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>                <span class="k">raise</span> <span class="ne">ResourceWarning</span><span class="p">(</span><span class="s2">&quot;TP Client send buffer is full!&quot;</span><span class="p">)</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span> <span class="o">+=</span> <span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__dataReadyEvent</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a><span class="sd">        Initiate connection to TP Server.</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a><span class="sd">        If successful, it starts the main processing loop of this client.</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a><span class="sd">        Does nothing if client is already connected.</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a><span class="sd">        **Note** that `connect()` blocks further execution of your script until one of the following occurs:</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a><span class="sd">          - `disconnect()` is called in an event handler,</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a><span class="sd">          - TP sends `closePlugin` message and `autoClose` is `True`</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a><span class="sd">          - or an internal error occurs (for example Touch Portal disconnects unexpectedly)</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isConnected</span><span class="p">():</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__open</span><span class="p">()</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;pair&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pluginId</span><span class="p">})</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">()</span>  <span class="c1"># start the event loop</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>    <span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a><span class="sd">        This closes the connection to TP and terminates the client processing loop.</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a><span class="sd">        Does nothing if client is already disconnected.</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isConnected</span><span class="p">():</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__close</span><span class="p">()</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>    <span class="k">def</span> <span class="nf">getActionDataValue</span><span class="p">(</span><span class="n">data</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">valueId</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a><span class="sd">        Utility for processing action messages from TP. For example:</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a><span class="sd">            {&quot;type&quot;: &quot;action&quot;, &quot;data&quot;: [{ &quot;id&quot;: &quot;data object id&quot;, &quot;value&quot;: &quot;user specified value&quot; }, ...]}</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a><span class="sd">        Returns the `value` with specific `id` from a list of action data,</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a><span class="sd">        or `None` if the `id` wasn&#39;t found. If a null id is passed in `valueId`</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a><span class="sd">        then the first entry which has a `value` key, if any, will be returned.</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a><span class="sd">        Args:</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a><span class="sd">            `data`: the &quot;data&quot; array from a TP &quot;action&quot;, &quot;on&quot;, or &quot;off&quot; message</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a><span class="sd">            `valueId`: the &quot;id&quot; to look for in `data`. `None` or blank to return the first value found.</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>        <span class="k">if</span> <span class="n">valueId</span><span class="p">:</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>            <span class="k">return</span> <span class="nb">next</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">valueId</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>        <span class="k">return</span> <span class="nb">next</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="Client">
                            <input id="Client-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Client</span><wbr>(<span class="base">pyee._executor.ExecutorEventEmitter</span>):

                <label class="view-source-button" for="Client-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client-83"><a href="#Client-83"><span class="linenos"> 83</span></a><span class="k">class</span> <span class="nc">Client</span><span class="p">(</span><span class="n">ExecutorEventEmitter</span><span class="p">):</span>
</span><span id="Client-84"><a href="#Client-84"><span class="linenos"> 84</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-85"><a href="#Client-85"><span class="linenos"> 85</span></a><span class="sd">    A TCP/IP client for [Touch Portal API](https://www.touch-portal.com/api) plugin integration.</span>
</span><span id="Client-86"><a href="#Client-86"><span class="linenos"> 86</span></a><span class="sd">    Implements a [pyee.ExecutorEventEmitter](https://pyee.readthedocs.io/en/latest/#pyee.ExecutorEventEmitter).</span>
</span><span id="Client-87"><a href="#Client-87"><span class="linenos"> 87</span></a>
</span><span id="Client-88"><a href="#Client-88"><span class="linenos"> 88</span></a><span class="sd">    After an initial connection to a Touch Portal desktop application &quot;server,&quot; the client</span>
</span><span id="Client-89"><a href="#Client-89"><span class="linenos"> 89</span></a><span class="sd">    implements a send/receive event loop while maintaining the open sockets. Messages between</span>
</span><span id="Client-90"><a href="#Client-90"><span class="linenos"> 90</span></a><span class="sd">    TP and the plugin are exchanged asynchronously, with all sending methods possibly returning</span>
</span><span id="Client-91"><a href="#Client-91"><span class="linenos"> 91</span></a><span class="sd">    before the actual data is sent.</span>
</span><span id="Client-92"><a href="#Client-92"><span class="linenos"> 92</span></a>
</span><span id="Client-93"><a href="#Client-93"><span class="linenos"> 93</span></a><span class="sd">    Messages from Touch Portal are delivered to the plugin script via event handler callbacks,</span>
</span><span id="Client-94"><a href="#Client-94"><span class="linenos"> 94</span></a><span class="sd">    which can be either individual callbacks per message type, and/or a single handler for all</span>
</span><span id="Client-95"><a href="#Client-95"><span class="linenos"> 95</span></a><span class="sd">    types of messages. The callbacks are executed in separate Thread(s), using a pool of up to</span>
</span><span id="Client-96"><a href="#Client-96"><span class="linenos"> 96</span></a><span class="sd">    any number of concurrent threads as needed (if using more than one thread, the plugin</span>
</span><span id="Client-97"><a href="#Client-97"><span class="linenos"> 97</span></a><span class="sd">    code itself is responsible for thread safety of its internal data). Please check the</span>
</span><span id="Client-98"><a href="#Client-98"><span class="linenos"> 98</span></a><span class="sd">    `pyee.EventEmitter` documentation for general information on how events are handled</span>
</span><span id="Client-99"><a href="#Client-99"><span class="linenos"> 99</span></a><span class="sd">    (which can be either via function decorators or via the inherited `Client.on()` method).</span>
</span><span id="Client-100"><a href="#Client-100"><span class="linenos">100</span></a>
</span><span id="Client-101"><a href="#Client-101"><span class="linenos">101</span></a><span class="sd">    Generated event names correspond to Touch Portal API message types, one for each type</span>
</span><span id="Client-102"><a href="#Client-102"><span class="linenos">102</span></a><span class="sd">    as defined in the TP API documentation (eg. &quot;action&quot; or &quot;listChange&quot;) as well as one event</span>
</span><span id="Client-103"><a href="#Client-103"><span class="linenos">103</span></a><span class="sd">    which is generated for all message types (&quot;any&quot;). Alternately, for a more formal approach,</span>
</span><span id="Client-104"><a href="#Client-104"><span class="linenos">104</span></a><span class="sd">    the corresponding members of the `TYPES` class could be used instead of string names</span>
</span><span id="Client-105"><a href="#Client-105"><span class="linenos">105</span></a><span class="sd">    (eg. `TYPES.onAction` or `TYPES.onListChange`).</span>
</span><span id="Client-106"><a href="#Client-106"><span class="linenos">106</span></a>
</span><span id="Client-107"><a href="#Client-107"><span class="linenos">107</span></a><span class="sd">    Any errors raised within event listeners/handlers are trapped and then reported in the</span>
</span><span id="Client-108"><a href="#Client-108"><span class="linenos">108</span></a><span class="sd">    inherited &quot;error&quot; event (from pyee.ExecutorEventEmitter), aka `TYPES.onError`.</span>
</span><span id="Client-109"><a href="#Client-109"><span class="linenos">109</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Client-110"><a href="#Client-110"><span class="linenos">110</span></a>    <span class="n">TPHOST</span> <span class="o">=</span> <span class="s1">&#39;127.0.0.1&#39;</span>
</span><span id="Client-111"><a href="#Client-111"><span class="linenos">111</span></a>    <span class="sd">&quot;&quot;&quot; TP plugin server host IPv4 address. &quot;&quot;&quot;</span>
</span><span id="Client-112"><a href="#Client-112"><span class="linenos">112</span></a>    <span class="n">TPPORT</span> <span class="o">=</span> <span class="mi">12136</span>
</span><span id="Client-113"><a href="#Client-113"><span class="linenos">113</span></a>    <span class="sd">&quot;&quot;&quot; TP plugin server host IPv4 port number. &quot;&quot;&quot;</span>
</span><span id="Client-114"><a href="#Client-114"><span class="linenos">114</span></a>    <span class="n">RCV_BUFFER_SZ</span> <span class="o">=</span> <span class="mi">4096</span>
</span><span id="Client-115"><a href="#Client-115"><span class="linenos">115</span></a>    <span class="sd">&quot;&quot;&quot; [B] incoming data buffer size. &quot;&quot;&quot;</span>
</span><span id="Client-116"><a href="#Client-116"><span class="linenos">116</span></a>    <span class="n">SND_BUFFER_SZ</span> <span class="o">=</span> <span class="mi">32</span><span class="o">**</span><span class="mi">4</span>
</span><span id="Client-117"><a href="#Client-117"><span class="linenos">117</span></a>    <span class="sd">&quot;&quot;&quot; [B] maximum size of send data buffer (1MB). &quot;&quot;&quot;</span>
</span><span id="Client-118"><a href="#Client-118"><span class="linenos">118</span></a>    <span class="n">SOCK_EVENT_TO</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="Client-119"><a href="#Client-119"><span class="linenos">119</span></a>    <span class="sd">&quot;&quot;&quot; [s] maximum wait time for socket events (blocking timeout for selector.select()). &quot;&quot;&quot;</span>
</span><span id="Client-120"><a href="#Client-120"><span class="linenos">120</span></a>
</span><span id="Client-121"><a href="#Client-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pluginId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
</span><span id="Client-122"><a href="#Client-122"><span class="linenos">122</span></a>                 <span class="n">sleepPeriod</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
</span><span id="Client-123"><a href="#Client-123"><span class="linenos">123</span></a>                 <span class="n">autoClose</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Client-124"><a href="#Client-124"><span class="linenos">124</span></a>                 <span class="n">checkPluginId</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Client-125"><a href="#Client-125"><span class="linenos">125</span></a>                 <span class="n">updateStatesOnBroadcast</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Client-126"><a href="#Client-126"><span class="linenos">126</span></a>                 <span class="n">maxWorkers</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Client-127"><a href="#Client-127"><span class="linenos">127</span></a>                 <span class="n">executor</span><span class="p">:</span><span class="n">Executor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Client-128"><a href="#Client-128"><span class="linenos">128</span></a>                 <span class="n">useNamespaceCallbacks</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Client-129"><a href="#Client-129"><span class="linenos">129</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-130"><a href="#Client-130"><span class="linenos">130</span></a><span class="sd">        Creates an instance of the client.</span>
</span><span id="Client-131"><a href="#Client-131"><span class="linenos">131</span></a>
</span><span id="Client-132"><a href="#Client-132"><span class="linenos">132</span></a><span class="sd">        Args:</span>
</span><span id="Client-133"><a href="#Client-133"><span class="linenos">133</span></a><span class="sd">            `pluginId`: ID string of the TouchPortal plugin using this client. **Required.**</span>
</span><span id="Client-134"><a href="#Client-134"><span class="linenos">134</span></a><span class="sd">            `sleepPeriod`: Seconds to sleep the event loop between socket read events. Default: 0.01</span>
</span><span id="Client-135"><a href="#Client-135"><span class="linenos">135</span></a><span class="sd">            `autoClose`: If `True` then this client will automatically disconnect when a `closePlugin` message is received from TP.</span>
</span><span id="Client-136"><a href="#Client-136"><span class="linenos">136</span></a><span class="sd">                Default is `False`.</span>
</span><span id="Client-137"><a href="#Client-137"><span class="linenos">137</span></a><span class="sd">            `checkPluginId`: Validate that `pluginId` matches ours in any messages from TP which contain one (such as actions).</span>
</span><span id="Client-138"><a href="#Client-138"><span class="linenos">138</span></a><span class="sd">                Default is `True`.</span>
</span><span id="Client-139"><a href="#Client-139"><span class="linenos">139</span></a><span class="sd">            `updateStatesOnBroadcast`: Re-send all cached State values whenever user switches TP page.</span>
</span><span id="Client-140"><a href="#Client-140"><span class="linenos">140</span></a><span class="sd">                Default is `True`.</span>
</span><span id="Client-141"><a href="#Client-141"><span class="linenos">141</span></a><span class="sd">            `maxWorkers`: Maximum worker threads to run concurrently for event handlers.</span>
</span><span id="Client-142"><a href="#Client-142"><span class="linenos">142</span></a><span class="sd">                Default of `None` creates a default-constructed `ThreadPoolExecutor`.</span>
</span><span id="Client-143"><a href="#Client-143"><span class="linenos">143</span></a><span class="sd">            `executor`: Passed to `pyee.ExecutorEventEmitter`. By default this is a default-constructed</span>
</span><span id="Client-144"><a href="#Client-144"><span class="linenos">144</span></a><span class="sd">                [ThreadPoolExecutor](https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.ThreadPoolExecutor),</span>
</span><span id="Client-145"><a href="#Client-145"><span class="linenos">145</span></a><span class="sd">                optionally using `maxWorkers` concurrent threads.</span>
</span><span id="Client-146"><a href="#Client-146"><span class="linenos">146</span></a><span class="sd">            `useNamespaceCallbacks`: use NamespaceCallback as message handler</span>
</span><span id="Client-147"><a href="#Client-147"><span class="linenos">147</span></a><span class="sd">                Default is `False` meaning It will send normal json</span>
</span><span id="Client-148"><a href="#Client-148"><span class="linenos">148</span></a><span class="sd">                `True` meaning It will automatically convert json to namespace to make easier access value </span>
</span><span id="Client-149"><a href="#Client-149"><span class="linenos">149</span></a><span class="sd">                eg json: data[&#39;actionId&#39;][&#39;value&#39;] and namespace would be data.actionId.value</span>
</span><span id="Client-150"><a href="#Client-150"><span class="linenos">150</span></a>
</span><span id="Client-151"><a href="#Client-151"><span class="linenos">151</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-152"><a href="#Client-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">executor</span> <span class="ow">and</span> <span class="n">maxWorkers</span><span class="p">:</span>
</span><span id="Client-153"><a href="#Client-153"><span class="linenos">153</span></a>            <span class="n">executor</span> <span class="o">=</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">maxWorkers</span><span class="p">)</span>
</span><span id="Client-154"><a href="#Client-154"><span class="linenos">154</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Client</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">executor</span><span class="o">=</span><span class="n">executor</span><span class="p">)</span>
</span><span id="Client-155"><a href="#Client-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pluginId</span> <span class="o">=</span> <span class="n">pluginId</span>
</span><span id="Client-156"><a href="#Client-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sleepPeriod</span> <span class="o">=</span> <span class="n">sleepPeriod</span>
</span><span id="Client-157"><a href="#Client-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">autoClose</span> <span class="o">=</span> <span class="n">autoClose</span>
</span><span id="Client-158"><a href="#Client-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkPluginId</span> <span class="o">=</span> <span class="n">checkPluginId</span>
</span><span id="Client-159"><a href="#Client-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">updateStatesOnBroadcast</span> <span class="o">=</span> <span class="n">updateStatesOnBroadcast</span>
</span><span id="Client-160"><a href="#Client-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">useNamespaceCallbacks</span> <span class="o">=</span> <span class="n">useNamespaceCallbacks</span>
</span><span id="Client-161"><a href="#Client-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Client-162"><a href="#Client-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Client-163"><a href="#Client-163"><span class="linenos">163</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Client-164"><a href="#Client-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">currentSettings</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Client-165"><a href="#Client-165"><span class="linenos">165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">choiceUpdateList</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Client-166"><a href="#Client-166"><span class="linenos">166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shortIdTracker</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Client-167"><a href="#Client-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__heldActions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Client-168"><a href="#Client-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>       <span class="c1"># main loop inerrupt</span>
</span><span id="Client-169"><a href="#Client-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>           <span class="c1"># not running yet</span>
</span><span id="Client-170"><a href="#Client-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__dataReadyEvent</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>  <span class="c1"># set when __sendBuffer has data</span>
</span><span id="Client-171"><a href="#Client-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>        <span class="c1"># mutex for __sendBuffer</span>
</span><span id="Client-172"><a href="#Client-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span><span id="Client-173"><a href="#Client-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__recvBuffer</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span><span id="Client-174"><a href="#Client-174"><span class="linenos">174</span></a>            
</span><span id="Client-175"><a href="#Client-175"><span class="linenos">175</span></a>    <span class="k">def</span> <span class="nf">__buffered_readLine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client-176"><a href="#Client-176"><span class="linenos">176</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Client-177"><a href="#Client-177"><span class="linenos">177</span></a>            <span class="c1"># Should be ready to read</span>
</span><span id="Client-178"><a href="#Client-178"><span class="linenos">178</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RCV_BUFFER_SZ</span><span class="p">)</span>
</span><span id="Client-179"><a href="#Client-179"><span class="linenos">179</span></a>        <span class="k">except</span> <span class="ne">BlockingIOError</span><span class="p">:</span>
</span><span id="Client-180"><a href="#Client-180"><span class="linenos">180</span></a>            <span class="k">pass</span>  <span class="c1"># Resource temporarily unavailable (errno EWOULDBLOCK)</span>
</span><span id="Client-181"><a href="#Client-181"><span class="linenos">181</span></a>        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
</span><span id="Client-182"><a href="#Client-182"><span class="linenos">182</span></a>            <span class="k">raise</span>  <span class="c1"># No connection</span>
</span><span id="Client-183"><a href="#Client-183"><span class="linenos">183</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Client-184"><a href="#Client-184"><span class="linenos">184</span></a>            <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
</span><span id="Client-185"><a href="#Client-185"><span class="linenos">185</span></a>                <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Client-186"><a href="#Client-186"><span class="linenos">186</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__recvBuffer</span> <span class="o">+=</span> <span class="n">data</span>
</span><span id="Client-187"><a href="#Client-187"><span class="linenos">187</span></a>                <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recvBuffer</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="Client-188"><a href="#Client-188"><span class="linenos">188</span></a>                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__recvBuffer</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span>
</span><span id="Client-189"><a href="#Client-189"><span class="linenos">189</span></a>                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recvBuffer</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Client-190"><a href="#Client-190"><span class="linenos">190</span></a>                <span class="k">return</span> <span class="n">lines</span>
</span><span id="Client-191"><a href="#Client-191"><span class="linenos">191</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Client-192"><a href="#Client-192"><span class="linenos">192</span></a>                <span class="c1"># No connection</span>
</span><span id="Client-193"><a href="#Client-193"><span class="linenos">193</span></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Peer closed the connection.&quot;</span><span class="p">)</span>
</span><span id="Client-194"><a href="#Client-194"><span class="linenos">194</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span><span id="Client-195"><a href="#Client-195"><span class="linenos">195</span></a>
</span><span id="Client-196"><a href="#Client-196"><span class="linenos">196</span></a>    <span class="k">def</span> <span class="nf">__write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client-197"><a href="#Client-197"><span class="linenos">197</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getWriteLock</span><span class="p">():</span>
</span><span id="Client-198"><a href="#Client-198"><span class="linenos">198</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Client-199"><a href="#Client-199"><span class="linenos">199</span></a>                <span class="c1"># Should be ready to write</span>
</span><span id="Client-200"><a href="#Client-200"><span class="linenos">200</span></a>                <span class="n">sent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span><span class="p">)</span>
</span><span id="Client-201"><a href="#Client-201"><span class="linenos">201</span></a>            <span class="k">except</span> <span class="ne">BlockingIOError</span><span class="p">:</span>
</span><span id="Client-202"><a href="#Client-202"><span class="linenos">202</span></a>                <span class="k">pass</span>  <span class="c1"># Resource temporarily unavailable (errno EWOULDBLOCK)</span>
</span><span id="Client-203"><a href="#Client-203"><span class="linenos">203</span></a>            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
</span><span id="Client-204"><a href="#Client-204"><span class="linenos">204</span></a>                <span class="k">raise</span>  <span class="c1"># No connection</span>
</span><span id="Client-205"><a href="#Client-205"><span class="linenos">205</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Client-206"><a href="#Client-206"><span class="linenos">206</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span><span class="p">[:</span><span class="n">sent</span><span class="p">]</span>
</span><span id="Client-207"><a href="#Client-207"><span class="linenos">207</span></a>            <span class="k">finally</span><span class="p">:</span>
</span><span id="Client-208"><a href="#Client-208"><span class="linenos">208</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span><span class="p">:</span>
</span><span id="Client-209"><a href="#Client-209"><span class="linenos">209</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__dataReadyEvent</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="Client-210"><a href="#Client-210"><span class="linenos">210</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="Client-211"><a href="#Client-211"><span class="linenos">211</span></a>
</span><span id="Client-212"><a href="#Client-212"><span class="linenos">212</span></a>    <span class="k">def</span> <span class="nf">__run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client-213"><a href="#Client-213"><span class="linenos">213</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Client-214"><a href="#Client-214"><span class="linenos">214</span></a>            <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
</span><span id="Client-215"><a href="#Client-215"><span class="linenos">215</span></a>                <span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">SOCK_EVENT_TO</span><span class="p">)</span>
</span><span id="Client-216"><a href="#Client-216"><span class="linenos">216</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>  <span class="c1"># may be set while waiting for selector events (unlikely)</span>
</span><span id="Client-217"><a href="#Client-217"><span class="linenos">217</span></a>                    <span class="k">break</span>
</span><span id="Client-218"><a href="#Client-218"><span class="linenos">218</span></a>                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">mask</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
</span><span id="Client-219"><a href="#Client-219"><span class="linenos">219</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="n">selectors</span><span class="o">.</span><span class="n">EVENT_READ</span><span class="p">):</span>
</span><span id="Client-220"><a href="#Client-220"><span class="linenos">220</span></a>                        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__buffered_readLine</span><span class="p">():</span>
</span><span id="Client-221"><a href="#Client-221"><span class="linenos">221</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">__processMessage</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="Client-222"><a href="#Client-222"><span class="linenos">222</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="n">selectors</span><span class="o">.</span><span class="n">EVENT_WRITE</span><span class="p">):</span>
</span><span id="Client-223"><a href="#Client-223"><span class="linenos">223</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">__write</span><span class="p">()</span>
</span><span id="Client-224"><a href="#Client-224"><span class="linenos">224</span></a>                <span class="c1"># Sleep for period or until there is data in the write buffer.</span>
</span><span id="Client-225"><a href="#Client-225"><span class="linenos">225</span></a>                <span class="c1"># In theory if data is constantly avaiable, this could block,</span>
</span><span id="Client-226"><a href="#Client-226"><span class="linenos">226</span></a>                <span class="c1"># in which case it may be better to self.__stopEvent.wait()</span>
</span><span id="Client-227"><a href="#Client-227"><span class="linenos">227</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataReadyEvent</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sleepPeriod</span><span class="p">):</span>
</span><span id="Client-228"><a href="#Client-228"><span class="linenos">228</span></a>                    <span class="k">continue</span>
</span><span id="Client-229"><a href="#Client-229"><span class="linenos">229</span></a>                <span class="k">continue</span>
</span><span id="Client-230"><a href="#Client-230"><span class="linenos">230</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Client-231"><a href="#Client-231"><span class="linenos">231</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__die</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception in client event loop: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span><span id="Client-232"><a href="#Client-232"><span class="linenos">232</span></a>
</span><span id="Client-233"><a href="#Client-233"><span class="linenos">233</span></a>    <span class="k">def</span> <span class="nf">__processMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
</span><span id="Client-234"><a href="#Client-234"><span class="linenos">234</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span><span id="Client-235"><a href="#Client-235"><span class="linenos">235</span></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">and</span> <span class="p">(</span><span class="n">act_type</span> <span class="o">:=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)):</span>
</span><span id="Client-236"><a href="#Client-236"><span class="linenos">236</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkPluginId</span> <span class="ow">and</span> <span class="p">(</span><span class="n">pid</span> <span class="o">:=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pluginId&#39;</span><span class="p">))</span> <span class="ow">and</span> <span class="n">pid</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pluginId</span><span class="p">:</span>
</span><span id="Client-237"><a href="#Client-237"><span class="linenos">237</span></a>                <span class="k">return</span>
</span><span id="Client-238"><a href="#Client-238"><span class="linenos">238</span></a>            <span class="k">if</span> <span class="n">act_type</span> <span class="o">==</span> <span class="n">TYPES</span><span class="o">.</span><span class="n">onShutdown</span><span class="p">:</span>
</span><span id="Client-239"><a href="#Client-239"><span class="linenos">239</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">autoClose</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__close</span><span class="p">()</span>
</span><span id="Client-240"><a href="#Client-240"><span class="linenos">240</span></a>            <span class="k">elif</span> <span class="n">act_type</span> <span class="o">==</span> <span class="n">TYPES</span><span class="o">.</span><span class="n">onHold_down</span> <span class="ow">and</span> <span class="p">(</span><span class="n">aid</span> <span class="o">:=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;actionId&#39;</span><span class="p">)):</span>
</span><span id="Client-241"><a href="#Client-241"><span class="linenos">241</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__heldActions</span><span class="p">[</span><span class="n">aid</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Client-242"><a href="#Client-242"><span class="linenos">242</span></a>            <span class="k">elif</span> <span class="n">act_type</span> <span class="o">==</span> <span class="n">TYPES</span><span class="o">.</span><span class="n">onHold_up</span> <span class="ow">and</span> <span class="p">(</span><span class="n">aid</span> <span class="o">:=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;actionId&#39;</span><span class="p">)):</span>
</span><span id="Client-243"><a href="#Client-243"><span class="linenos">243</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__heldActions</span><span class="p">[</span><span class="n">aid</span><span class="p">]</span>
</span><span id="Client-244"><a href="#Client-244"><span class="linenos">244</span></a>            <span class="k">elif</span> <span class="n">act_type</span> <span class="o">==</span> <span class="n">TYPES</span><span class="o">.</span><span class="n">onBroadcast</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">updateStatesOnBroadcast</span><span class="p">:</span>
</span><span id="Client-245"><a href="#Client-245"><span class="linenos">245</span></a>                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Client-246"><a href="#Client-246"><span class="linenos">246</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__stateUpdate</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Client-247"><a href="#Client-247"><span class="linenos">247</span></a>            <span class="k">elif</span> <span class="n">act_type</span> <span class="o">==</span> <span class="n">TYPES</span><span class="o">.</span><span class="n">shortConnectorIdNotification</span><span class="p">:</span>
</span><span id="Client-248"><a href="#Client-248"><span class="linenos">248</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">shortIdTracker</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;connectorId&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;shortId&#39;</span><span class="p">]</span>
</span><span id="Client-249"><a href="#Client-249"><span class="linenos">249</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__emitEvent</span><span class="p">(</span><span class="n">act_type</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="Client-250"><a href="#Client-250"><span class="linenos">250</span></a>
</span><span id="Client-251"><a href="#Client-251"><span class="linenos">251</span></a>    <span class="k">def</span> <span class="nf">__emitEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="Client-252"><a href="#Client-252"><span class="linenos">252</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">useNamespaceCallbacks</span><span class="p">:</span>
</span><span id="Client-253"><a href="#Client-253"><span class="linenos">253</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">ev</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="Client-254"><a href="#Client-254"><span class="linenos">254</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">TYPES</span><span class="o">.</span><span class="n">allMessage</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="Client-255"><a href="#Client-255"><span class="linenos">255</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Client-256"><a href="#Client-256"><span class="linenos">256</span></a>            <span class="n">convertedData</span> <span class="o">=</span> <span class="n">Tools</span><span class="o">.</span><span class="n">nested_conversion</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1"># No need to call this twice</span>
</span><span id="Client-257"><a href="#Client-257"><span class="linenos">257</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">ev</span><span class="p">,</span> <span class="n">convertedData</span><span class="p">)</span>
</span><span id="Client-258"><a href="#Client-258"><span class="linenos">258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">TYPES</span><span class="o">.</span><span class="n">allMessage</span><span class="p">,</span> <span class="n">convertedData</span><span class="p">)</span>
</span><span id="Client-259"><a href="#Client-259"><span class="linenos">259</span></a>
</span><span id="Client-260"><a href="#Client-260"><span class="linenos">260</span></a>    <span class="k">def</span> <span class="nf">__open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client-261"><a href="#Client-261"><span class="linenos">261</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Client-262"><a href="#Client-262"><span class="linenos">262</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span><span id="Client-263"><a href="#Client-263"><span class="linenos">263</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">selector</span> <span class="o">=</span> <span class="n">selectors</span><span class="o">.</span><span class="n">DefaultSelector</span><span class="p">()</span>
</span><span id="Client-264"><a href="#Client-264"><span class="linenos">264</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">TPHOST</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TPPORT</span><span class="p">))</span>
</span><span id="Client-265"><a href="#Client-265"><span class="linenos">265</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="Client-266"><a href="#Client-266"><span class="linenos">266</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">selector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Client-267"><a href="#Client-267"><span class="linenos">267</span></a>            <span class="k">raise</span>
</span><span id="Client-268"><a href="#Client-268"><span class="linenos">268</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">setblocking</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Client-269"><a href="#Client-269"><span class="linenos">269</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="p">(</span><span class="n">selectors</span><span class="o">.</span><span class="n">EVENT_READ</span> <span class="o">|</span> <span class="n">selectors</span><span class="o">.</span><span class="n">EVENT_WRITE</span><span class="p">))</span>
</span><span id="Client-270"><a href="#Client-270"><span class="linenos">270</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="Client-271"><a href="#Client-271"><span class="linenos">271</span></a>
</span><span id="Client-272"><a href="#Client-272"><span class="linenos">272</span></a>    <span class="k">def</span> <span class="nf">__close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client-273"><a href="#Client-273"><span class="linenos">273</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span><span id="Client-274"><a href="#Client-274"><span class="linenos">274</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">locked</span><span class="p">():</span>
</span><span id="Client-275"><a href="#Client-275"><span class="linenos">275</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="Client-276"><a href="#Client-276"><span class="linenos">276</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="Client-277"><a href="#Client-277"><span class="linenos">277</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="p">:</span>
</span><span id="Client-278"><a href="#Client-278"><span class="linenos">278</span></a>            <span class="k">return</span>
</span><span id="Client-279"><a href="#Client-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">get_map</span><span class="p">():</span>
</span><span id="Client-280"><a href="#Client-280"><span class="linenos">280</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Client-281"><a href="#Client-281"><span class="linenos">281</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">)</span>
</span><span id="Client-282"><a href="#Client-282"><span class="linenos">282</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Client-283"><a href="#Client-283"><span class="linenos">283</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in selector.unregister(): </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Client-284"><a href="#Client-284"><span class="linenos">284</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Client-285"><a href="#Client-285"><span class="linenos">285</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SHUT_RDWR</span><span class="p">)</span>
</span><span id="Client-286"><a href="#Client-286"><span class="linenos">286</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Client-287"><a href="#Client-287"><span class="linenos">287</span></a>        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Client-288"><a href="#Client-288"><span class="linenos">288</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in socket.close(): </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Client-289"><a href="#Client-289"><span class="linenos">289</span></a>        <span class="k">finally</span><span class="p">:</span>
</span><span id="Client-290"><a href="#Client-290"><span class="linenos">290</span></a>            <span class="c1"># Delete reference to socket object for garbage collection, socket cannot be reused anyway.</span>
</span><span id="Client-291"><a href="#Client-291"><span class="linenos">291</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Client-292"><a href="#Client-292"><span class="linenos">292</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Client-293"><a href="#Client-293"><span class="linenos">293</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Client-294"><a href="#Client-294"><span class="linenos">294</span></a>        <span class="c1"># print(&quot;TP Client stopped.&quot;)</span>
</span><span id="Client-295"><a href="#Client-295"><span class="linenos">295</span></a>
</span><span id="Client-296"><a href="#Client-296"><span class="linenos">296</span></a>    <span class="k">def</span> <span class="nf">__die</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Client-297"><a href="#Client-297"><span class="linenos">297</span></a>        <span class="k">if</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="Client-298"><a href="#Client-298"><span class="linenos">298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__emitEvent</span><span class="p">(</span><span class="n">TYPES</span><span class="o">.</span><span class="n">onShutdown</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">TYPES</span><span class="o">.</span><span class="n">onShutdown</span><span class="p">})</span>
</span><span id="Client-299"><a href="#Client-299"><span class="linenos">299</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__close</span><span class="p">()</span>
</span><span id="Client-300"><a href="#Client-300"><span class="linenos">300</span></a>        <span class="k">if</span> <span class="n">exc</span><span class="p">:</span>
</span><span id="Client-301"><a href="#Client-301"><span class="linenos">301</span></a>            <span class="k">raise</span> <span class="n">exc</span>
</span><span id="Client-302"><a href="#Client-302"><span class="linenos">302</span></a>
</span><span id="Client-303"><a href="#Client-303"><span class="linenos">303</span></a>    <span class="k">def</span> <span class="nf">__getWriteLock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client-304"><a href="#Client-304"><span class="linenos">304</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">15</span><span class="p">):</span>
</span><span id="Client-305"><a href="#Client-305"><span class="linenos">305</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
</span><span id="Client-306"><a href="#Client-306"><span class="linenos">306</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">locked</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="Client-307"><a href="#Client-307"><span class="linenos">307</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="Client-308"><a href="#Client-308"><span class="linenos">308</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Client-309"><a href="#Client-309"><span class="linenos">309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__die</span><span class="p">(</span><span class="n">exc</span><span class="o">=</span><span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Send buffer mutex deadlock, cannot continue.&quot;</span><span class="p">))</span>
</span><span id="Client-310"><a href="#Client-310"><span class="linenos">310</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="Client-311"><a href="#Client-311"><span class="linenos">311</span></a>
</span><span id="Client-312"><a href="#Client-312"><span class="linenos">312</span></a>    <span class="k">def</span> <span class="nf">isConnected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client-313"><a href="#Client-313"><span class="linenos">313</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-314"><a href="#Client-314"><span class="linenos">314</span></a><span class="sd">        Returns `True` if the Client is connected to Touch Portal, `False` otherwise.</span>
</span><span id="Client-315"><a href="#Client-315"><span class="linenos">315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-316"><a href="#Client-316"><span class="linenos">316</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span>
</span><span id="Client-317"><a href="#Client-317"><span class="linenos">317</span></a>
</span><span id="Client-318"><a href="#Client-318"><span class="linenos">318</span></a>    <span class="k">def</span> <span class="nf">isActionBeingHeld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actionId</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
</span><span id="Client-319"><a href="#Client-319"><span class="linenos">319</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-320"><a href="#Client-320"><span class="linenos">320</span></a><span class="sd">        For an Action with ID of `actionId` that can be held (`hasHoldFunctionality` is true),</span>
</span><span id="Client-321"><a href="#Client-321"><span class="linenos">321</span></a><span class="sd">        this method returns `True` while it is being held and `False` otherwise.</span>
</span><span id="Client-322"><a href="#Client-322"><span class="linenos">322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-323"><a href="#Client-323"><span class="linenos">323</span></a>        <span class="k">return</span> <span class="n">actionId</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__heldActions</span>
</span><span id="Client-324"><a href="#Client-324"><span class="linenos">324</span></a>
</span><span id="Client-325"><a href="#Client-325"><span class="linenos">325</span></a>    <span class="k">def</span> <span class="nf">createState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">parentGroup</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Client-326"><a href="#Client-326"><span class="linenos">326</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-327"><a href="#Client-327"><span class="linenos">327</span></a><span class="sd">        This will create a TP State at runtime. `stateId`, `description`, and `value` (`value` becomes the State&#39;s default value) are all required except `parentGroup` which allow you to create states in a `folder`.</span>
</span><span id="Client-328"><a href="#Client-328"><span class="linenos">328</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-329"><a href="#Client-329"><span class="linenos">329</span></a>        <span class="k">if</span> <span class="n">stateId</span> <span class="ow">and</span> <span class="n">description</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Client-330"><a href="#Client-330"><span class="linenos">330</span></a>            <span class="k">if</span> <span class="n">stateId</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="p">:</span>
</span><span id="Client-331"><a href="#Client-331"><span class="linenos">331</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;createState&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">stateId</span><span class="p">,</span> <span class="s2">&quot;desc&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span> <span class="s2">&quot;defaultValue&quot;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span> <span class="s2">&quot;parentGroup&quot;</span><span class="p">:</span> <span class="n">parentGroup</span><span class="p">})</span>
</span><span id="Client-332"><a href="#Client-332"><span class="linenos">332</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="p">[</span><span class="n">stateId</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="Client-333"><a href="#Client-333"><span class="linenos">333</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Client-334"><a href="#Client-334"><span class="linenos">334</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stateUpdate</span><span class="p">(</span><span class="n">stateId</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="Client-335"><a href="#Client-335"><span class="linenos">335</span></a>
</span><span id="Client-336"><a href="#Client-336"><span class="linenos">336</span></a>    <span class="k">def</span> <span class="nf">createStateMany</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
</span><span id="Client-337"><a href="#Client-337"><span class="linenos">337</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-338"><a href="#Client-338"><span class="linenos">338</span></a><span class="sd">        Convenience function to create several States at once. `states` should be an iteratable of `dict` types</span>
</span><span id="Client-339"><a href="#Client-339"><span class="linenos">339</span></a><span class="sd">        in the form of `{&#39;id&#39;: &quot;StateId&quot;, &#39;desc&#39;: &quot;Description&quot;, &#39;value&#39;: &quot;Default Value&quot;}` and optionally `&#39;parentGroup&#39;: &quot;Value&quot;` which will make state `folder`.</span>
</span><span id="Client-340"><a href="#Client-340"><span class="linenos">340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-341"><a href="#Client-341"><span class="linenos">341</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Client-342"><a href="#Client-342"><span class="linenos">342</span></a>            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
</span><span id="Client-343"><a href="#Client-343"><span class="linenos">343</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="Client-344"><a href="#Client-344"><span class="linenos">344</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">createState</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;parentGroup&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
</span><span id="Client-345"><a href="#Client-345"><span class="linenos">345</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Client-346"><a href="#Client-346"><span class="linenos">346</span></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;createStateMany() requires a list of dicts, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="si">}</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
</span><span id="Client-347"><a href="#Client-347"><span class="linenos">347</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="Client-348"><a href="#Client-348"><span class="linenos">348</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;createStateMany() requires an iteratable, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="si">}</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
</span><span id="Client-349"><a href="#Client-349"><span class="linenos">349</span></a>
</span><span id="Client-350"><a href="#Client-350"><span class="linenos">350</span></a>    <span class="k">def</span> <span class="nf">removeState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">validateExists</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Client-351"><a href="#Client-351"><span class="linenos">351</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-352"><a href="#Client-352"><span class="linenos">352</span></a><span class="sd">        This removes a State that has been created at runtime. `stateId` is the ID to remove.</span>
</span><span id="Client-353"><a href="#Client-353"><span class="linenos">353</span></a><span class="sd">        If `validateExists` is True (default) this method will raise an Exception if the `stateId`</span>
</span><span id="Client-354"><a href="#Client-354"><span class="linenos">354</span></a><span class="sd">        does not exist in the current state cache.</span>
</span><span id="Client-355"><a href="#Client-355"><span class="linenos">355</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-356"><a href="#Client-356"><span class="linenos">356</span></a>        <span class="k">if</span> <span class="n">stateId</span> <span class="ow">and</span> <span class="n">stateId</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="p">:</span>
</span><span id="Client-357"><a href="#Client-357"><span class="linenos">357</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;removeState&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">stateId</span><span class="p">})</span>
</span><span id="Client-358"><a href="#Client-358"><span class="linenos">358</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">stateId</span><span class="p">)</span>
</span><span id="Client-359"><a href="#Client-359"><span class="linenos">359</span></a>        <span class="k">elif</span> <span class="n">validateExists</span><span class="p">:</span>
</span><span id="Client-360"><a href="#Client-360"><span class="linenos">360</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stateId</span><span class="si">}</span><span class="s2"> Does not exist.&quot;</span><span class="p">)</span>
</span><span id="Client-361"><a href="#Client-361"><span class="linenos">361</span></a>
</span><span id="Client-362"><a href="#Client-362"><span class="linenos">362</span></a>    <span class="k">def</span> <span class="nf">removeStateMany</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
</span><span id="Client-363"><a href="#Client-363"><span class="linenos">363</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-364"><a href="#Client-364"><span class="linenos">364</span></a><span class="sd">        Convenience function to remove several States at once. `states` should be an iteratable of state ID strings.</span>
</span><span id="Client-365"><a href="#Client-365"><span class="linenos">365</span></a><span class="sd">        This method does not validate if the states exist in the current state cache. See also: `removeState`.</span>
</span><span id="Client-366"><a href="#Client-366"><span class="linenos">366</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-367"><a href="#Client-367"><span class="linenos">367</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Client-368"><a href="#Client-368"><span class="linenos">368</span></a>            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
</span><span id="Client-369"><a href="#Client-369"><span class="linenos">369</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">removeState</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="Client-370"><a href="#Client-370"><span class="linenos">370</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Client-371"><a href="#Client-371"><span class="linenos">371</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;removeStateMany() requires an iteratable, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="si">}</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
</span><span id="Client-372"><a href="#Client-372"><span class="linenos">372</span></a>
</span><span id="Client-373"><a href="#Client-373"><span class="linenos">373</span></a>    <span class="k">def</span> <span class="nf">choiceUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">choiceId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
</span><span id="Client-374"><a href="#Client-374"><span class="linenos">374</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-375"><a href="#Client-375"><span class="linenos">375</span></a><span class="sd">        This updates the list of choices in a previously-declared TP State with id `stateId`.</span>
</span><span id="Client-376"><a href="#Client-376"><span class="linenos">376</span></a><span class="sd">        See TP API reference for details on updating list values.</span>
</span><span id="Client-377"><a href="#Client-377"><span class="linenos">377</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-378"><a href="#Client-378"><span class="linenos">378</span></a>        <span class="k">if</span> <span class="n">choiceId</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Client-379"><a href="#Client-379"><span class="linenos">379</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;choiceUpdate&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">choiceId</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">})</span>
</span><span id="Client-380"><a href="#Client-380"><span class="linenos">380</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">choiceUpdateList</span><span class="p">[</span><span class="n">choiceId</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
</span><span id="Client-381"><a href="#Client-381"><span class="linenos">381</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Client-382"><a href="#Client-382"><span class="linenos">382</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;choiceUpdate() values argument needs to be a list not a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Client-383"><a href="#Client-383"><span class="linenos">383</span></a>
</span><span id="Client-384"><a href="#Client-384"><span class="linenos">384</span></a>    <span class="k">def</span> <span class="nf">choiceUpdateSpecific</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">instanceId</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
</span><span id="Client-385"><a href="#Client-385"><span class="linenos">385</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-386"><a href="#Client-386"><span class="linenos">386</span></a><span class="sd">        This updates a list of choices in a specific TP Item Instance, specified in `instanceId`.</span>
</span><span id="Client-387"><a href="#Client-387"><span class="linenos">387</span></a><span class="sd">        See TP API reference for details on updating specific instances.</span>
</span><span id="Client-388"><a href="#Client-388"><span class="linenos">388</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-389"><a href="#Client-389"><span class="linenos">389</span></a>        <span class="k">if</span> <span class="n">stateId</span> <span class="ow">and</span> <span class="n">instanceId</span><span class="p">:</span>
</span><span id="Client-390"><a href="#Client-390"><span class="linenos">390</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Client-391"><a href="#Client-391"><span class="linenos">391</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;choiceUpdate&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">stateId</span><span class="p">,</span> <span class="s2">&quot;instanceId&quot;</span><span class="p">:</span> <span class="n">instanceId</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">})</span>
</span><span id="Client-392"><a href="#Client-392"><span class="linenos">392</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Client-393"><a href="#Client-393"><span class="linenos">393</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;choiceUpdateSpecific() values argument needs to be a list not a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Client-394"><a href="#Client-394"><span class="linenos">394</span></a>
</span><span id="Client-395"><a href="#Client-395"><span class="linenos">395</span></a>    <span class="k">def</span> <span class="nf">settingUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settingName</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">settingValue</span><span class="p">):</span>
</span><span id="Client-396"><a href="#Client-396"><span class="linenos">396</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-397"><a href="#Client-397"><span class="linenos">397</span></a><span class="sd">        This updates a value named `settingName` in your plugin&#39;s Settings to `settingValue`.</span>
</span><span id="Client-398"><a href="#Client-398"><span class="linenos">398</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-399"><a href="#Client-399"><span class="linenos">399</span></a>        <span class="k">if</span> <span class="n">settingName</span> <span class="ow">and</span> <span class="n">settingName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentSettings</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentSettings</span><span class="p">[</span><span class="n">settingName</span><span class="p">]</span> <span class="o">!=</span> <span class="n">settingValue</span><span class="p">:</span>
</span><span id="Client-400"><a href="#Client-400"><span class="linenos">400</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;settingUpdate&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">settingName</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">settingValue</span><span class="p">})</span>
</span><span id="Client-401"><a href="#Client-401"><span class="linenos">401</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">currentSettings</span><span class="p">[</span><span class="n">settingName</span><span class="p">]</span> <span class="o">=</span> <span class="n">settingValue</span>
</span><span id="Client-402"><a href="#Client-402"><span class="linenos">402</span></a>
</span><span id="Client-403"><a href="#Client-403"><span class="linenos">403</span></a>    <span class="k">def</span> <span class="nf">stateUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">stateValue</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
</span><span id="Client-404"><a href="#Client-404"><span class="linenos">404</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-405"><a href="#Client-405"><span class="linenos">405</span></a><span class="sd">        This updates a value in ether a pre-defined static State or a dynamic State created in runtime.</span>
</span><span id="Client-406"><a href="#Client-406"><span class="linenos">406</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-407"><a href="#Client-407"><span class="linenos">407</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__stateUpdate</span><span class="p">(</span><span class="n">stateId</span><span class="p">,</span> <span class="n">stateValue</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="Client-408"><a href="#Client-408"><span class="linenos">408</span></a>
</span><span id="Client-409"><a href="#Client-409"><span class="linenos">409</span></a>    <span class="k">def</span> <span class="nf">__stateUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">stateValue</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">forced</span><span class="p">:</span><span class="nb">bool</span><span class="p">):</span>
</span><span id="Client-410"><a href="#Client-410"><span class="linenos">410</span></a>        <span class="k">if</span> <span class="n">stateId</span><span class="p">:</span>
</span><span id="Client-411"><a href="#Client-411"><span class="linenos">411</span></a>            <span class="k">if</span> <span class="n">forced</span> <span class="ow">or</span> <span class="n">stateId</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="p">[</span><span class="n">stateId</span><span class="p">]</span> <span class="o">!=</span> <span class="n">stateValue</span><span class="p">:</span>
</span><span id="Client-412"><a href="#Client-412"><span class="linenos">412</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;stateUpdate&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">stateId</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">stateValue</span><span class="p">})</span>
</span><span id="Client-413"><a href="#Client-413"><span class="linenos">413</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="p">[</span><span class="n">stateId</span><span class="p">]</span> <span class="o">=</span> <span class="n">stateValue</span>
</span><span id="Client-414"><a href="#Client-414"><span class="linenos">414</span></a>
</span><span id="Client-415"><a href="#Client-415"><span class="linenos">415</span></a>    <span class="k">def</span> <span class="nf">stateUpdateMany</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
</span><span id="Client-416"><a href="#Client-416"><span class="linenos">416</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-417"><a href="#Client-417"><span class="linenos">417</span></a><span class="sd">        Convenience function to update several states at once.</span>
</span><span id="Client-418"><a href="#Client-418"><span class="linenos">418</span></a><span class="sd">        `states` should be an iteratable of `dict` types in the form of `{&#39;id&#39;: &quot;StateId&quot;, &#39;value&#39;: &quot;The New Value&quot;}`.</span>
</span><span id="Client-419"><a href="#Client-419"><span class="linenos">419</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-420"><a href="#Client-420"><span class="linenos">420</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Client-421"><a href="#Client-421"><span class="linenos">421</span></a>            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
</span><span id="Client-422"><a href="#Client-422"><span class="linenos">422</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="Client-423"><a href="#Client-423"><span class="linenos">423</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stateUpdate</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
</span><span id="Client-424"><a href="#Client-424"><span class="linenos">424</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Client-425"><a href="#Client-425"><span class="linenos">425</span></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;StateUpdateMany() requires a list of dicts, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="si">}</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
</span><span id="Client-426"><a href="#Client-426"><span class="linenos">426</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Client-427"><a href="#Client-427"><span class="linenos">427</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;StateUpdateMany() requires an iteratable, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="si">}</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
</span><span id="Client-428"><a href="#Client-428"><span class="linenos">428</span></a>
</span><span id="Client-429"><a href="#Client-429"><span class="linenos">429</span></a>    <span class="k">def</span> <span class="nf">showNotification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">notificationId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
</span><span id="Client-430"><a href="#Client-430"><span class="linenos">430</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-431"><a href="#Client-431"><span class="linenos">431</span></a><span class="sd">        This method allows your plugin to send a notification to Touch Portal with custom title, message body and available user action(s).</span>
</span><span id="Client-432"><a href="#Client-432"><span class="linenos">432</span></a><span class="sd">        Requires TP SDK v4.0 or higher.</span>
</span><span id="Client-433"><a href="#Client-433"><span class="linenos">433</span></a>
</span><span id="Client-434"><a href="#Client-434"><span class="linenos">434</span></a><span class="sd">        Args:</span>
</span><span id="Client-435"><a href="#Client-435"><span class="linenos">435</span></a><span class="sd">            `notificationId`: Unique ID of this notification.</span>
</span><span id="Client-436"><a href="#Client-436"><span class="linenos">436</span></a><span class="sd">            `title`: The notification title.</span>
</span><span id="Client-437"><a href="#Client-437"><span class="linenos">437</span></a><span class="sd">            `msg`: The message body text that is shown in the notifcation.</span>
</span><span id="Client-438"><a href="#Client-438"><span class="linenos">438</span></a><span class="sd">            `options`: List of options (actions) for the notification. Each option should be a `dict` type with `id` and `title` keys.</span>
</span><span id="Client-439"><a href="#Client-439"><span class="linenos">439</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-440"><a href="#Client-440"><span class="linenos">440</span></a>        <span class="k">if</span> <span class="n">notificationId</span> <span class="ow">and</span> <span class="n">title</span> <span class="ow">and</span> <span class="n">msg</span> <span class="ow">and</span> <span class="n">options</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Client-441"><a href="#Client-441"><span class="linenos">441</span></a>            <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
</span><span id="Client-442"><a href="#Client-442"><span class="linenos">442</span></a>                <span class="k">if</span> <span class="s1">&#39;id&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">option</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;title&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">option</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Client-443"><a href="#Client-443"><span class="linenos">443</span></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;all options require id and title keys&quot;</span><span class="p">)</span>
</span><span id="Client-444"><a href="#Client-444"><span class="linenos">444</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span>
</span><span id="Client-445"><a href="#Client-445"><span class="linenos">445</span></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;showNotification&quot;</span><span class="p">,</span>
</span><span id="Client-446"><a href="#Client-446"><span class="linenos">446</span></a>                <span class="s2">&quot;notificationId&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">notificationId</span><span class="p">),</span>
</span><span id="Client-447"><a href="#Client-447"><span class="linenos">447</span></a>                <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">),</span>
</span><span id="Client-448"><a href="#Client-448"><span class="linenos">448</span></a>                <span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span>
</span><span id="Client-449"><a href="#Client-449"><span class="linenos">449</span></a>                <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="n">options</span>
</span><span id="Client-450"><a href="#Client-450"><span class="linenos">450</span></a>            <span class="p">})</span>
</span><span id="Client-451"><a href="#Client-451"><span class="linenos">451</span></a>
</span><span id="Client-452"><a href="#Client-452"><span class="linenos">452</span></a>    <span class="k">def</span> <span class="nf">shortIdUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shortId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">connectorValue</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="Client-453"><a href="#Client-453"><span class="linenos">453</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-454"><a href="#Client-454"><span class="linenos">454</span></a><span class="sd">        This allows you to update slider position value using shortId which TouchPortal will broadcast.</span>
</span><span id="Client-455"><a href="#Client-455"><span class="linenos">455</span></a>
</span><span id="Client-456"><a href="#Client-456"><span class="linenos">456</span></a><span class="sd">        Args:</span>
</span><span id="Client-457"><a href="#Client-457"><span class="linenos">457</span></a><span class="sd">            `shortId`: a shortId is a id that is mapped to connectorId by TouchPortal</span>
</span><span id="Client-458"><a href="#Client-458"><span class="linenos">458</span></a><span class="sd">            `connectorValue`: A integer between 0-100</span>
</span><span id="Client-459"><a href="#Client-459"><span class="linenos">459</span></a>
</span><span id="Client-460"><a href="#Client-460"><span class="linenos">460</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-461"><a href="#Client-461"><span class="linenos">461</span></a>        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">connectorValue</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">:</span>
</span><span id="Client-462"><a href="#Client-462"><span class="linenos">462</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span>
</span><span id="Client-463"><a href="#Client-463"><span class="linenos">463</span></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;connectorUpdate&quot;</span><span class="p">,</span>
</span><span id="Client-464"><a href="#Client-464"><span class="linenos">464</span></a>                <span class="s2">&quot;shortId&quot;</span><span class="p">:</span> <span class="n">shortId</span><span class="p">,</span>
</span><span id="Client-465"><a href="#Client-465"><span class="linenos">465</span></a>                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">connectorValue</span><span class="p">)</span>
</span><span id="Client-466"><a href="#Client-466"><span class="linenos">466</span></a>            <span class="p">})</span>
</span><span id="Client-467"><a href="#Client-467"><span class="linenos">467</span></a>
</span><span id="Client-468"><a href="#Client-468"><span class="linenos">468</span></a>    <span class="k">def</span> <span class="nf">connectorUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connectorId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">connectorValue</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="Client-469"><a href="#Client-469"><span class="linenos">469</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-470"><a href="#Client-470"><span class="linenos">470</span></a><span class="sd">        This allows you to update slider position value.</span>
</span><span id="Client-471"><a href="#Client-471"><span class="linenos">471</span></a>
</span><span id="Client-472"><a href="#Client-472"><span class="linenos">472</span></a><span class="sd">        Args:</span>
</span><span id="Client-473"><a href="#Client-473"><span class="linenos">473</span></a><span class="sd">            `connectorId`: Cannot be longer then 200 characters.</span>
</span><span id="Client-474"><a href="#Client-474"><span class="linenos">474</span></a><span class="sd">                connectorId have syntax that you need to follow https://www.touch-portal.com/api/index.php?section=connectors</span>
</span><span id="Client-475"><a href="#Client-475"><span class="linenos">475</span></a><span class="sd">                Also according to that site It requires you to have prefix &quot;pc_yourPluginId_&quot; + connectorid however This already provide</span>
</span><span id="Client-476"><a href="#Client-476"><span class="linenos">476</span></a><span class="sd">                you the prefix and the pluginId so you just need you take care the rest eg connectorid|setting1=aValue</span>
</span><span id="Client-477"><a href="#Client-477"><span class="linenos">477</span></a><span class="sd">            `connectorValue`: Must be an integer between 0-100.</span>
</span><span id="Client-478"><a href="#Client-478"><span class="linenos">478</span></a>
</span><span id="Client-479"><a href="#Client-479"><span class="linenos">479</span></a><span class="sd">        Note: This method will automatically looking for shortId using gaven connectorId however if It cannot find shortId it will just send connectorId</span>
</span><span id="Client-480"><a href="#Client-480"><span class="linenos">480</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-481"><a href="#Client-481"><span class="linenos">481</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">connectorId</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Client-482"><a href="#Client-482"><span class="linenos">482</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;connectorId needs to be a str not a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">connectorId</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Client-483"><a href="#Client-483"><span class="linenos">483</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">connectorValue</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Client-484"><a href="#Client-484"><span class="linenos">484</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;connectorValue requires a int not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">connectorValue</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Client-485"><a href="#Client-485"><span class="linenos">485</span></a>        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">connectorValue</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">:</span>
</span><span id="Client-486"><a href="#Client-486"><span class="linenos">486</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">cid</span> <span class="o">:=</span> <span class="sa">f</span><span class="s2">&quot;pc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pluginId</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">connectorId</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shortIdTracker</span><span class="p">:</span>
</span><span id="Client-487"><a href="#Client-487"><span class="linenos">487</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">shortIdUpdate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shortIdTracker</span><span class="p">[</span><span class="n">cid</span><span class="p">],</span> <span class="n">connectorValue</span><span class="p">)</span>
</span><span id="Client-488"><a href="#Client-488"><span class="linenos">488</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Client-489"><a href="#Client-489"><span class="linenos">489</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span>
</span><span id="Client-490"><a href="#Client-490"><span class="linenos">490</span></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;connectorUpdate&quot;</span><span class="p">,</span>
</span><span id="Client-491"><a href="#Client-491"><span class="linenos">491</span></a>                    <span class="s2">&quot;connectorId&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;pc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pluginId</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">connectorId</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="Client-492"><a href="#Client-492"><span class="linenos">492</span></a>                    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">connectorValue</span><span class="p">)</span>
</span><span id="Client-493"><a href="#Client-493"><span class="linenos">493</span></a>                <span class="p">})</span>
</span><span id="Client-494"><a href="#Client-494"><span class="linenos">494</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Client-495"><a href="#Client-495"><span class="linenos">495</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;connectorValue needs to be between 0-100 not </span><span class="si">{</span><span class="n">connectorValue</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Client-496"><a href="#Client-496"><span class="linenos">496</span></a>
</span><span id="Client-497"><a href="#Client-497"><span class="linenos">497</span></a>    <span class="k">def</span> <span class="nf">updateActionData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instanceId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">minValue</span><span class="p">,</span> <span class="n">maxValue</span><span class="p">):</span>
</span><span id="Client-498"><a href="#Client-498"><span class="linenos">498</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-499"><a href="#Client-499"><span class="linenos">499</span></a><span class="sd">        This allows you to update Action Data in one of your Action. Currently TouchPortal only supports changing the minimum and maximum values in numeric data types.</span>
</span><span id="Client-500"><a href="#Client-500"><span class="linenos">500</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-501"><a href="#Client-501"><span class="linenos">501</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;updateActionData&quot;</span><span class="p">,</span> <span class="s2">&quot;instanceId&quot;</span><span class="p">:</span> <span class="n">instanceId</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;minValue&quot;</span><span class="p">:</span> <span class="n">minValue</span><span class="p">,</span> <span class="s2">&quot;maxValue&quot;</span><span class="p">:</span> <span class="n">maxValue</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">stateId</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">}})</span>
</span><span id="Client-502"><a href="#Client-502"><span class="linenos">502</span></a>
</span><span id="Client-503"><a href="#Client-503"><span class="linenos">503</span></a>    <span class="k">def</span> <span class="nf">getChoiceUpdatelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client-504"><a href="#Client-504"><span class="linenos">504</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-505"><a href="#Client-505"><span class="linenos">505</span></a><span class="sd">        This will return a dict that `choiceUpdate` registered.</span>
</span><span id="Client-506"><a href="#Client-506"><span class="linenos">506</span></a><span class="sd">            example return value `{&quot;choiceUpdateid1&quot;: [&quot;item1&quot;, &quot;item2&quot;, &quot;item3&quot;], &quot;exampleChoiceId&quot;: [&quot;Option1&quot;, &quot;Option2&quot;, &quot;Option3&quot;]}`</span>
</span><span id="Client-507"><a href="#Client-507"><span class="linenos">507</span></a>
</span><span id="Client-508"><a href="#Client-508"><span class="linenos">508</span></a><span class="sd">        You should use this to verify before Updating the choice list    </span>
</span><span id="Client-509"><a href="#Client-509"><span class="linenos">509</span></a><span class="sd">        **Note** This is the same as TPClient.choiceUpdateList variable *DO NOT MODIFY* TPClient.choiceUpdateList unless you know what your doing</span>
</span><span id="Client-510"><a href="#Client-510"><span class="linenos">510</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-511"><a href="#Client-511"><span class="linenos">511</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">choiceUpdateList</span>
</span><span id="Client-512"><a href="#Client-512"><span class="linenos">512</span></a>
</span><span id="Client-513"><a href="#Client-513"><span class="linenos">513</span></a>    <span class="k">def</span> <span class="nf">getStatelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client-514"><a href="#Client-514"><span class="linenos">514</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-515"><a href="#Client-515"><span class="linenos">515</span></a><span class="sd">        This will return a dict that have key pair of states that you last updated.</span>
</span><span id="Client-516"><a href="#Client-516"><span class="linenos">516</span></a><span class="sd">            Example retun value `{&quot;stateId1&quot;: &quot;value1&quot;, &quot;stateId2&quot;: &quot;value2&quot;, &quot;stateId3&quot;: &quot;value3&quot;}`</span>
</span><span id="Client-517"><a href="#Client-517"><span class="linenos">517</span></a><span class="sd">        This is used to keep track of all states. It will be automatically updated when you update states</span>
</span><span id="Client-518"><a href="#Client-518"><span class="linenos">518</span></a><span class="sd">        **Note** This is the same as TPClient.currentState variable *DO NOT MODIFY* TPClient.currentState unless you know what your doing</span>
</span><span id="Client-519"><a href="#Client-519"><span class="linenos">519</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-520"><a href="#Client-520"><span class="linenos">520</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span>
</span><span id="Client-521"><a href="#Client-521"><span class="linenos">521</span></a>
</span><span id="Client-522"><a href="#Client-522"><span class="linenos">522</span></a>    <span class="k">def</span> <span class="nf">getSettinghistory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client-523"><a href="#Client-523"><span class="linenos">523</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-524"><a href="#Client-524"><span class="linenos">524</span></a><span class="sd">        This will return a dict that have key pair of setting value that you updated previously.</span>
</span><span id="Client-525"><a href="#Client-525"><span class="linenos">525</span></a>
</span><span id="Client-526"><a href="#Client-526"><span class="linenos">526</span></a><span class="sd">        This is used to track settings value that you have updated previously </span>
</span><span id="Client-527"><a href="#Client-527"><span class="linenos">527</span></a><span class="sd">        **Note** This is the same as TPClient.currentSettings variable *DO NOT MODIFY* TPClient.currentSettings unless you know what your doing</span>
</span><span id="Client-528"><a href="#Client-528"><span class="linenos">528</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-529"><a href="#Client-529"><span class="linenos">529</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentSettings</span>
</span><span id="Client-530"><a href="#Client-530"><span class="linenos">530</span></a>
</span><span id="Client-531"><a href="#Client-531"><span class="linenos">531</span></a>    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="Client-532"><a href="#Client-532"><span class="linenos">532</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-533"><a href="#Client-533"><span class="linenos">533</span></a><span class="sd">        This will try to send any arbitrary Python object in `data` (presumably something `dict`-like) to Touch Portal</span>
</span><span id="Client-534"><a href="#Client-534"><span class="linenos">534</span></a><span class="sd">        after serializing it as JSON and adding a `\n`. Normally there is no need to use this method directly, but if the</span>
</span><span id="Client-535"><a href="#Client-535"><span class="linenos">535</span></a><span class="sd">        Python API doesn&#39;t cover something from the TP API, this could be used instead.</span>
</span><span id="Client-536"><a href="#Client-536"><span class="linenos">536</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-537"><a href="#Client-537"><span class="linenos">537</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getWriteLock</span><span class="p">():</span>
</span><span id="Client-538"><a href="#Client-538"><span class="linenos">538</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SND_BUFFER_SZ</span><span class="p">:</span>
</span><span id="Client-539"><a href="#Client-539"><span class="linenos">539</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="Client-540"><a href="#Client-540"><span class="linenos">540</span></a>                <span class="k">raise</span> <span class="ne">ResourceWarning</span><span class="p">(</span><span class="s2">&quot;TP Client send buffer is full!&quot;</span><span class="p">)</span>
</span><span id="Client-541"><a href="#Client-541"><span class="linenos">541</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span> <span class="o">+=</span> <span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span><span id="Client-542"><a href="#Client-542"><span class="linenos">542</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="Client-543"><a href="#Client-543"><span class="linenos">543</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__dataReadyEvent</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span><span id="Client-544"><a href="#Client-544"><span class="linenos">544</span></a>
</span><span id="Client-545"><a href="#Client-545"><span class="linenos">545</span></a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client-546"><a href="#Client-546"><span class="linenos">546</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-547"><a href="#Client-547"><span class="linenos">547</span></a><span class="sd">        Initiate connection to TP Server.</span>
</span><span id="Client-548"><a href="#Client-548"><span class="linenos">548</span></a><span class="sd">        If successful, it starts the main processing loop of this client.</span>
</span><span id="Client-549"><a href="#Client-549"><span class="linenos">549</span></a><span class="sd">        Does nothing if client is already connected.</span>
</span><span id="Client-550"><a href="#Client-550"><span class="linenos">550</span></a>
</span><span id="Client-551"><a href="#Client-551"><span class="linenos">551</span></a><span class="sd">        **Note** that `connect()` blocks further execution of your script until one of the following occurs:</span>
</span><span id="Client-552"><a href="#Client-552"><span class="linenos">552</span></a><span class="sd">          - `disconnect()` is called in an event handler,</span>
</span><span id="Client-553"><a href="#Client-553"><span class="linenos">553</span></a><span class="sd">          - TP sends `closePlugin` message and `autoClose` is `True`</span>
</span><span id="Client-554"><a href="#Client-554"><span class="linenos">554</span></a><span class="sd">          - or an internal error occurs (for example Touch Portal disconnects unexpectedly)</span>
</span><span id="Client-555"><a href="#Client-555"><span class="linenos">555</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-556"><a href="#Client-556"><span class="linenos">556</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isConnected</span><span class="p">():</span>
</span><span id="Client-557"><a href="#Client-557"><span class="linenos">557</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__open</span><span class="p">()</span>
</span><span id="Client-558"><a href="#Client-558"><span class="linenos">558</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;pair&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pluginId</span><span class="p">})</span>
</span><span id="Client-559"><a href="#Client-559"><span class="linenos">559</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">()</span>  <span class="c1"># start the event loop</span>
</span><span id="Client-560"><a href="#Client-560"><span class="linenos">560</span></a>
</span><span id="Client-561"><a href="#Client-561"><span class="linenos">561</span></a>    <span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client-562"><a href="#Client-562"><span class="linenos">562</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-563"><a href="#Client-563"><span class="linenos">563</span></a><span class="sd">        This closes the connection to TP and terminates the client processing loop.</span>
</span><span id="Client-564"><a href="#Client-564"><span class="linenos">564</span></a><span class="sd">        Does nothing if client is already disconnected.</span>
</span><span id="Client-565"><a href="#Client-565"><span class="linenos">565</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-566"><a href="#Client-566"><span class="linenos">566</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isConnected</span><span class="p">():</span>
</span><span id="Client-567"><a href="#Client-567"><span class="linenos">567</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__close</span><span class="p">()</span>
</span><span id="Client-568"><a href="#Client-568"><span class="linenos">568</span></a>
</span><span id="Client-569"><a href="#Client-569"><span class="linenos">569</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Client-570"><a href="#Client-570"><span class="linenos">570</span></a>    <span class="k">def</span> <span class="nf">getActionDataValue</span><span class="p">(</span><span class="n">data</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">valueId</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Client-571"><a href="#Client-571"><span class="linenos">571</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client-572"><a href="#Client-572"><span class="linenos">572</span></a><span class="sd">        Utility for processing action messages from TP. For example:</span>
</span><span id="Client-573"><a href="#Client-573"><span class="linenos">573</span></a><span class="sd">            {&quot;type&quot;: &quot;action&quot;, &quot;data&quot;: [{ &quot;id&quot;: &quot;data object id&quot;, &quot;value&quot;: &quot;user specified value&quot; }, ...]}</span>
</span><span id="Client-574"><a href="#Client-574"><span class="linenos">574</span></a>
</span><span id="Client-575"><a href="#Client-575"><span class="linenos">575</span></a><span class="sd">        Returns the `value` with specific `id` from a list of action data,</span>
</span><span id="Client-576"><a href="#Client-576"><span class="linenos">576</span></a><span class="sd">        or `None` if the `id` wasn&#39;t found. If a null id is passed in `valueId`</span>
</span><span id="Client-577"><a href="#Client-577"><span class="linenos">577</span></a><span class="sd">        then the first entry which has a `value` key, if any, will be returned.</span>
</span><span id="Client-578"><a href="#Client-578"><span class="linenos">578</span></a>
</span><span id="Client-579"><a href="#Client-579"><span class="linenos">579</span></a><span class="sd">        Args:</span>
</span><span id="Client-580"><a href="#Client-580"><span class="linenos">580</span></a><span class="sd">            `data`: the &quot;data&quot; array from a TP &quot;action&quot;, &quot;on&quot;, or &quot;off&quot; message</span>
</span><span id="Client-581"><a href="#Client-581"><span class="linenos">581</span></a><span class="sd">            `valueId`: the &quot;id&quot; to look for in `data`. `None` or blank to return the first value found.</span>
</span><span id="Client-582"><a href="#Client-582"><span class="linenos">582</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client-583"><a href="#Client-583"><span class="linenos">583</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
</span><span id="Client-584"><a href="#Client-584"><span class="linenos">584</span></a>        <span class="k">if</span> <span class="n">valueId</span><span class="p">:</span>
</span><span id="Client-585"><a href="#Client-585"><span class="linenos">585</span></a>            <span class="k">return</span> <span class="nb">next</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">valueId</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="Client-586"><a href="#Client-586"><span class="linenos">586</span></a>        <span class="k">return</span> <span class="nb">next</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A TCP/IP client for <a href="https://www.touch-portal.com/api">Touch Portal API</a> plugin integration.
Implements a <a href="https://pyee.readthedocs.io/en/latest/#pyee.ExecutorEventEmitter">pyee.ExecutorEventEmitter</a>.</p>

<p>After an initial connection to a Touch Portal desktop application "server," the client
implements a send/receive event loop while maintaining the open sockets. Messages between
TP and the plugin are exchanged asynchronously, with all sending methods possibly returning
before the actual data is sent.</p>

<p>Messages from Touch Portal are delivered to the plugin script via event handler callbacks,
which can be either individual callbacks per message type, and/or a single handler for all
types of messages. The callbacks are executed in separate Thread(s), using a pool of up to
any number of concurrent threads as needed (if using more than one thread, the plugin
code itself is responsible for thread safety of its internal data). Please check the
<code>pyee.EventEmitter</code> documentation for general information on how events are handled
(which can be either via function decorators or via the inherited <code><a href="#Client.on">Client.on()</a></code> method).</p>

<p>Generated event names correspond to Touch Portal API message types, one for each type
as defined in the TP API documentation (eg. "action" or "listChange") as well as one event
which is generated for all message types ("any"). Alternately, for a more formal approach,
the corresponding members of the <code><a href="#TYPES">TYPES</a></code> class could be used instead of string names
(eg. <code><a href="#TYPES.onAction">TYPES.onAction</a></code> or <code><a href="#TYPES.onListChange">TYPES.onListChange</a></code>).</p>

<p>Any errors raised within event listeners/handlers are trapped and then reported in the
inherited "error" event (from pyee.ExecutorEventEmitter), aka <code><a href="#TYPES.onError">TYPES.onError</a></code>.</p>
</div>


                            <div id="Client.__init__" class="classattr">
                                        <input id="Client.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Client</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">pluginId</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">sleepPeriod</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span>,</span><span class="param">	<span class="n">autoClose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">checkPluginId</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">updateStatesOnBroadcast</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">maxWorkers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">executor</span><span class="p">:</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">_base</span><span class="o">.</span><span class="n">Executor</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">useNamespaceCallbacks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span>)</span>

                <label class="view-source-button" for="Client.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.__init__-121"><a href="#Client.__init__-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pluginId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
</span><span id="Client.__init__-122"><a href="#Client.__init__-122"><span class="linenos">122</span></a>                 <span class="n">sleepPeriod</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
</span><span id="Client.__init__-123"><a href="#Client.__init__-123"><span class="linenos">123</span></a>                 <span class="n">autoClose</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Client.__init__-124"><a href="#Client.__init__-124"><span class="linenos">124</span></a>                 <span class="n">checkPluginId</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Client.__init__-125"><a href="#Client.__init__-125"><span class="linenos">125</span></a>                 <span class="n">updateStatesOnBroadcast</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Client.__init__-126"><a href="#Client.__init__-126"><span class="linenos">126</span></a>                 <span class="n">maxWorkers</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Client.__init__-127"><a href="#Client.__init__-127"><span class="linenos">127</span></a>                 <span class="n">executor</span><span class="p">:</span><span class="n">Executor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Client.__init__-128"><a href="#Client.__init__-128"><span class="linenos">128</span></a>                 <span class="n">useNamespaceCallbacks</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Client.__init__-129"><a href="#Client.__init__-129"><span class="linenos">129</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.__init__-130"><a href="#Client.__init__-130"><span class="linenos">130</span></a><span class="sd">        Creates an instance of the client.</span>
</span><span id="Client.__init__-131"><a href="#Client.__init__-131"><span class="linenos">131</span></a>
</span><span id="Client.__init__-132"><a href="#Client.__init__-132"><span class="linenos">132</span></a><span class="sd">        Args:</span>
</span><span id="Client.__init__-133"><a href="#Client.__init__-133"><span class="linenos">133</span></a><span class="sd">            `pluginId`: ID string of the TouchPortal plugin using this client. **Required.**</span>
</span><span id="Client.__init__-134"><a href="#Client.__init__-134"><span class="linenos">134</span></a><span class="sd">            `sleepPeriod`: Seconds to sleep the event loop between socket read events. Default: 0.01</span>
</span><span id="Client.__init__-135"><a href="#Client.__init__-135"><span class="linenos">135</span></a><span class="sd">            `autoClose`: If `True` then this client will automatically disconnect when a `closePlugin` message is received from TP.</span>
</span><span id="Client.__init__-136"><a href="#Client.__init__-136"><span class="linenos">136</span></a><span class="sd">                Default is `False`.</span>
</span><span id="Client.__init__-137"><a href="#Client.__init__-137"><span class="linenos">137</span></a><span class="sd">            `checkPluginId`: Validate that `pluginId` matches ours in any messages from TP which contain one (such as actions).</span>
</span><span id="Client.__init__-138"><a href="#Client.__init__-138"><span class="linenos">138</span></a><span class="sd">                Default is `True`.</span>
</span><span id="Client.__init__-139"><a href="#Client.__init__-139"><span class="linenos">139</span></a><span class="sd">            `updateStatesOnBroadcast`: Re-send all cached State values whenever user switches TP page.</span>
</span><span id="Client.__init__-140"><a href="#Client.__init__-140"><span class="linenos">140</span></a><span class="sd">                Default is `True`.</span>
</span><span id="Client.__init__-141"><a href="#Client.__init__-141"><span class="linenos">141</span></a><span class="sd">            `maxWorkers`: Maximum worker threads to run concurrently for event handlers.</span>
</span><span id="Client.__init__-142"><a href="#Client.__init__-142"><span class="linenos">142</span></a><span class="sd">                Default of `None` creates a default-constructed `ThreadPoolExecutor`.</span>
</span><span id="Client.__init__-143"><a href="#Client.__init__-143"><span class="linenos">143</span></a><span class="sd">            `executor`: Passed to `pyee.ExecutorEventEmitter`. By default this is a default-constructed</span>
</span><span id="Client.__init__-144"><a href="#Client.__init__-144"><span class="linenos">144</span></a><span class="sd">                [ThreadPoolExecutor](https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.ThreadPoolExecutor),</span>
</span><span id="Client.__init__-145"><a href="#Client.__init__-145"><span class="linenos">145</span></a><span class="sd">                optionally using `maxWorkers` concurrent threads.</span>
</span><span id="Client.__init__-146"><a href="#Client.__init__-146"><span class="linenos">146</span></a><span class="sd">            `useNamespaceCallbacks`: use NamespaceCallback as message handler</span>
</span><span id="Client.__init__-147"><a href="#Client.__init__-147"><span class="linenos">147</span></a><span class="sd">                Default is `False` meaning It will send normal json</span>
</span><span id="Client.__init__-148"><a href="#Client.__init__-148"><span class="linenos">148</span></a><span class="sd">                `True` meaning It will automatically convert json to namespace to make easier access value </span>
</span><span id="Client.__init__-149"><a href="#Client.__init__-149"><span class="linenos">149</span></a><span class="sd">                eg json: data[&#39;actionId&#39;][&#39;value&#39;] and namespace would be data.actionId.value</span>
</span><span id="Client.__init__-150"><a href="#Client.__init__-150"><span class="linenos">150</span></a>
</span><span id="Client.__init__-151"><a href="#Client.__init__-151"><span class="linenos">151</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.__init__-152"><a href="#Client.__init__-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">executor</span> <span class="ow">and</span> <span class="n">maxWorkers</span><span class="p">:</span>
</span><span id="Client.__init__-153"><a href="#Client.__init__-153"><span class="linenos">153</span></a>            <span class="n">executor</span> <span class="o">=</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">maxWorkers</span><span class="p">)</span>
</span><span id="Client.__init__-154"><a href="#Client.__init__-154"><span class="linenos">154</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Client</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">executor</span><span class="o">=</span><span class="n">executor</span><span class="p">)</span>
</span><span id="Client.__init__-155"><a href="#Client.__init__-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pluginId</span> <span class="o">=</span> <span class="n">pluginId</span>
</span><span id="Client.__init__-156"><a href="#Client.__init__-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sleepPeriod</span> <span class="o">=</span> <span class="n">sleepPeriod</span>
</span><span id="Client.__init__-157"><a href="#Client.__init__-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">autoClose</span> <span class="o">=</span> <span class="n">autoClose</span>
</span><span id="Client.__init__-158"><a href="#Client.__init__-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkPluginId</span> <span class="o">=</span> <span class="n">checkPluginId</span>
</span><span id="Client.__init__-159"><a href="#Client.__init__-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">updateStatesOnBroadcast</span> <span class="o">=</span> <span class="n">updateStatesOnBroadcast</span>
</span><span id="Client.__init__-160"><a href="#Client.__init__-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">useNamespaceCallbacks</span> <span class="o">=</span> <span class="n">useNamespaceCallbacks</span>
</span><span id="Client.__init__-161"><a href="#Client.__init__-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Client.__init__-162"><a href="#Client.__init__-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Client.__init__-163"><a href="#Client.__init__-163"><span class="linenos">163</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Client.__init__-164"><a href="#Client.__init__-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">currentSettings</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Client.__init__-165"><a href="#Client.__init__-165"><span class="linenos">165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">choiceUpdateList</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Client.__init__-166"><a href="#Client.__init__-166"><span class="linenos">166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shortIdTracker</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Client.__init__-167"><a href="#Client.__init__-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__heldActions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Client.__init__-168"><a href="#Client.__init__-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>       <span class="c1"># main loop inerrupt</span>
</span><span id="Client.__init__-169"><a href="#Client.__init__-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>           <span class="c1"># not running yet</span>
</span><span id="Client.__init__-170"><a href="#Client.__init__-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__dataReadyEvent</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>  <span class="c1"># set when __sendBuffer has data</span>
</span><span id="Client.__init__-171"><a href="#Client.__init__-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>        <span class="c1"># mutex for __sendBuffer</span>
</span><span id="Client.__init__-172"><a href="#Client.__init__-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span><span id="Client.__init__-173"><a href="#Client.__init__-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__recvBuffer</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Creates an instance of the client.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong><code>pluginId</code>:</strong>  ID string of the TouchPortal plugin using this client. <strong>Required.</strong></li>
<li><strong><code>sleepPeriod</code>:</strong>  Seconds to sleep the event loop between socket read events. Default: 0.01</li>
<li><strong><code>autoClose</code>:</strong>  If <code>True</code> then this client will automatically disconnect when a <code>closePlugin</code> message is received from TP.
Default is <code>False</code>.</li>
<li><strong><code>checkPluginId</code>:</strong>  Validate that <code>pluginId</code> matches ours in any messages from TP which contain one (such as actions).
Default is <code>True</code>.</li>
<li><strong><code>updateStatesOnBroadcast</code>:</strong>  Re-send all cached State values whenever user switches TP page.
Default is <code>True</code>.</li>
<li><strong><code>maxWorkers</code>:</strong>  Maximum worker threads to run concurrently for event handlers.
Default of <code>None</code> creates a default-constructed <code>ThreadPoolExecutor</code>.</li>
<li><strong><code>executor</code>:</strong>  Passed to <code>pyee.ExecutorEventEmitter</code>. By default this is a default-constructed
<a href="https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.ThreadPoolExecutor">ThreadPoolExecutor</a>,
optionally using <code>maxWorkers</code> concurrent threads.</li>
<li><strong><code>useNamespaceCallbacks</code>:</strong>  use NamespaceCallback as message handler
Default is <code>False</code> meaning It will send normal json
<code>True</code> meaning It will automatically convert json to namespace to make easier access value 
eg json: data['actionId']['value'] and namespace would be data.actionId.value</li>
</ul>
</div>


                            </div>
                            <div id="Client.TPHOST" class="classattr">
                                <div class="attr variable">
            <span class="name">TPHOST</span><span class="default_value"> = &#39;127.0.0.1&#39;</span>

        
    </div>
    <a class="headerlink" href="#Client.TPHOST"></a>
    
            <div class="docstring"><p>TP plugin server host IPv4 address.</p>
</div>


                            </div>
                            <div id="Client.TPPORT" class="classattr">
                                <div class="attr variable">
            <span class="name">TPPORT</span><span class="default_value"> = 12136</span>

        
    </div>
    <a class="headerlink" href="#Client.TPPORT"></a>
    
            <div class="docstring"><p>TP plugin server host IPv4 port number.</p>
</div>


                            </div>
                            <div id="Client.RCV_BUFFER_SZ" class="classattr">
                                <div class="attr variable">
            <span class="name">RCV_BUFFER_SZ</span><span class="default_value"> = 4096</span>

        
    </div>
    <a class="headerlink" href="#Client.RCV_BUFFER_SZ"></a>
    
            <div class="docstring"><p>[B] incoming data buffer size.</p>
</div>


                            </div>
                            <div id="Client.SND_BUFFER_SZ" class="classattr">
                                <div class="attr variable">
            <span class="name">SND_BUFFER_SZ</span><span class="default_value"> = 1048576</span>

        
    </div>
    <a class="headerlink" href="#Client.SND_BUFFER_SZ"></a>
    
            <div class="docstring"><p>[B] maximum size of send data buffer (1MB).</p>
</div>


                            </div>
                            <div id="Client.SOCK_EVENT_TO" class="classattr">
                                <div class="attr variable">
            <span class="name">SOCK_EVENT_TO</span><span class="default_value"> = 1.0</span>

        
    </div>
    <a class="headerlink" href="#Client.SOCK_EVENT_TO"></a>
    
            <div class="docstring"><p>[s] maximum wait time for socket events (blocking timeout for selector.select()).</p>
</div>


                            </div>
                            <div id="Client.isConnected" class="classattr">
                                        <input id="Client.isConnected-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">isConnected</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="Client.isConnected-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.isConnected"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.isConnected-312"><a href="#Client.isConnected-312"><span class="linenos">312</span></a>    <span class="k">def</span> <span class="nf">isConnected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client.isConnected-313"><a href="#Client.isConnected-313"><span class="linenos">313</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.isConnected-314"><a href="#Client.isConnected-314"><span class="linenos">314</span></a><span class="sd">        Returns `True` if the Client is connected to Touch Portal, `False` otherwise.</span>
</span><span id="Client.isConnected-315"><a href="#Client.isConnected-315"><span class="linenos">315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.isConnected-316"><a href="#Client.isConnected-316"><span class="linenos">316</span></a>        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stopEvent</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Returns <code>True</code> if the Client is connected to Touch Portal, <code>False</code> otherwise.</p>
</div>


                            </div>
                            <div id="Client.isActionBeingHeld" class="classattr">
                                        <input id="Client.isActionBeingHeld-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">isActionBeingHeld</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">actionId</span><span class="p">:</span> <span class="nb">str</span></span>)</span>

                <label class="view-source-button" for="Client.isActionBeingHeld-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.isActionBeingHeld"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.isActionBeingHeld-318"><a href="#Client.isActionBeingHeld-318"><span class="linenos">318</span></a>    <span class="k">def</span> <span class="nf">isActionBeingHeld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actionId</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
</span><span id="Client.isActionBeingHeld-319"><a href="#Client.isActionBeingHeld-319"><span class="linenos">319</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.isActionBeingHeld-320"><a href="#Client.isActionBeingHeld-320"><span class="linenos">320</span></a><span class="sd">        For an Action with ID of `actionId` that can be held (`hasHoldFunctionality` is true),</span>
</span><span id="Client.isActionBeingHeld-321"><a href="#Client.isActionBeingHeld-321"><span class="linenos">321</span></a><span class="sd">        this method returns `True` while it is being held and `False` otherwise.</span>
</span><span id="Client.isActionBeingHeld-322"><a href="#Client.isActionBeingHeld-322"><span class="linenos">322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.isActionBeingHeld-323"><a href="#Client.isActionBeingHeld-323"><span class="linenos">323</span></a>        <span class="k">return</span> <span class="n">actionId</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__heldActions</span>
</span></pre></div>


            <div class="docstring"><p>For an Action with ID of <code>actionId</code> that can be held (<code>hasHoldFunctionality</code> is true),
this method returns <code>True</code> while it is being held and <code>False</code> otherwise.</p>
</div>


                            </div>
                            <div id="Client.createState" class="classattr">
                                        <input id="Client.createState-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">createState</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">stateId</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">value</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">parentGroup</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Client.createState-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.createState"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.createState-325"><a href="#Client.createState-325"><span class="linenos">325</span></a>    <span class="k">def</span> <span class="nf">createState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">parentGroup</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Client.createState-326"><a href="#Client.createState-326"><span class="linenos">326</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.createState-327"><a href="#Client.createState-327"><span class="linenos">327</span></a><span class="sd">        This will create a TP State at runtime. `stateId`, `description`, and `value` (`value` becomes the State&#39;s default value) are all required except `parentGroup` which allow you to create states in a `folder`.</span>
</span><span id="Client.createState-328"><a href="#Client.createState-328"><span class="linenos">328</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.createState-329"><a href="#Client.createState-329"><span class="linenos">329</span></a>        <span class="k">if</span> <span class="n">stateId</span> <span class="ow">and</span> <span class="n">description</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Client.createState-330"><a href="#Client.createState-330"><span class="linenos">330</span></a>            <span class="k">if</span> <span class="n">stateId</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="p">:</span>
</span><span id="Client.createState-331"><a href="#Client.createState-331"><span class="linenos">331</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;createState&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">stateId</span><span class="p">,</span> <span class="s2">&quot;desc&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span> <span class="s2">&quot;defaultValue&quot;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span> <span class="s2">&quot;parentGroup&quot;</span><span class="p">:</span> <span class="n">parentGroup</span><span class="p">})</span>
</span><span id="Client.createState-332"><a href="#Client.createState-332"><span class="linenos">332</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="p">[</span><span class="n">stateId</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="Client.createState-333"><a href="#Client.createState-333"><span class="linenos">333</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Client.createState-334"><a href="#Client.createState-334"><span class="linenos">334</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stateUpdate</span><span class="p">(</span><span class="n">stateId</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This will create a TP State at runtime. <code>stateId</code>, <code>description</code>, and <code>value</code> (<code>value</code> becomes the State's default value) are all required except <code>parentGroup</code> which allow you to create states in a <code>folder</code>.</p>
</div>


                            </div>
                            <div id="Client.createStateMany" class="classattr">
                                        <input id="Client.createStateMany-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">createStateMany</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">states</span><span class="p">:</span> <span class="nb">list</span></span>)</span>

                <label class="view-source-button" for="Client.createStateMany-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.createStateMany"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.createStateMany-336"><a href="#Client.createStateMany-336"><span class="linenos">336</span></a>    <span class="k">def</span> <span class="nf">createStateMany</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
</span><span id="Client.createStateMany-337"><a href="#Client.createStateMany-337"><span class="linenos">337</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.createStateMany-338"><a href="#Client.createStateMany-338"><span class="linenos">338</span></a><span class="sd">        Convenience function to create several States at once. `states` should be an iteratable of `dict` types</span>
</span><span id="Client.createStateMany-339"><a href="#Client.createStateMany-339"><span class="linenos">339</span></a><span class="sd">        in the form of `{&#39;id&#39;: &quot;StateId&quot;, &#39;desc&#39;: &quot;Description&quot;, &#39;value&#39;: &quot;Default Value&quot;}` and optionally `&#39;parentGroup&#39;: &quot;Value&quot;` which will make state `folder`.</span>
</span><span id="Client.createStateMany-340"><a href="#Client.createStateMany-340"><span class="linenos">340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.createStateMany-341"><a href="#Client.createStateMany-341"><span class="linenos">341</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Client.createStateMany-342"><a href="#Client.createStateMany-342"><span class="linenos">342</span></a>            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
</span><span id="Client.createStateMany-343"><a href="#Client.createStateMany-343"><span class="linenos">343</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="Client.createStateMany-344"><a href="#Client.createStateMany-344"><span class="linenos">344</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">createState</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;parentGroup&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
</span><span id="Client.createStateMany-345"><a href="#Client.createStateMany-345"><span class="linenos">345</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Client.createStateMany-346"><a href="#Client.createStateMany-346"><span class="linenos">346</span></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;createStateMany() requires a list of dicts, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="si">}</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
</span><span id="Client.createStateMany-347"><a href="#Client.createStateMany-347"><span class="linenos">347</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="Client.createStateMany-348"><a href="#Client.createStateMany-348"><span class="linenos">348</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;createStateMany() requires an iteratable, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="si">}</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convenience function to create several States at once. <code>states</code> should be an iteratable of <code>dict</code> types
in the form of <code>{'id': "StateId", 'desc': "Description", 'value': "Default Value"}</code> and optionally <code>'parentGroup': "Value"</code> which will make state <code>folder</code>.</p>
</div>


                            </div>
                            <div id="Client.removeState" class="classattr">
                                        <input id="Client.removeState-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">removeState</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">stateId</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">validateExists</span><span class="o">=</span><span class="kc">True</span></span>)</span>

                <label class="view-source-button" for="Client.removeState-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.removeState"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.removeState-350"><a href="#Client.removeState-350"><span class="linenos">350</span></a>    <span class="k">def</span> <span class="nf">removeState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">validateExists</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Client.removeState-351"><a href="#Client.removeState-351"><span class="linenos">351</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.removeState-352"><a href="#Client.removeState-352"><span class="linenos">352</span></a><span class="sd">        This removes a State that has been created at runtime. `stateId` is the ID to remove.</span>
</span><span id="Client.removeState-353"><a href="#Client.removeState-353"><span class="linenos">353</span></a><span class="sd">        If `validateExists` is True (default) this method will raise an Exception if the `stateId`</span>
</span><span id="Client.removeState-354"><a href="#Client.removeState-354"><span class="linenos">354</span></a><span class="sd">        does not exist in the current state cache.</span>
</span><span id="Client.removeState-355"><a href="#Client.removeState-355"><span class="linenos">355</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.removeState-356"><a href="#Client.removeState-356"><span class="linenos">356</span></a>        <span class="k">if</span> <span class="n">stateId</span> <span class="ow">and</span> <span class="n">stateId</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="p">:</span>
</span><span id="Client.removeState-357"><a href="#Client.removeState-357"><span class="linenos">357</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;removeState&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">stateId</span><span class="p">})</span>
</span><span id="Client.removeState-358"><a href="#Client.removeState-358"><span class="linenos">358</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">stateId</span><span class="p">)</span>
</span><span id="Client.removeState-359"><a href="#Client.removeState-359"><span class="linenos">359</span></a>        <span class="k">elif</span> <span class="n">validateExists</span><span class="p">:</span>
</span><span id="Client.removeState-360"><a href="#Client.removeState-360"><span class="linenos">360</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stateId</span><span class="si">}</span><span class="s2"> Does not exist.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This removes a State that has been created at runtime. <code>stateId</code> is the ID to remove.
If <code>validateExists</code> is True (default) this method will raise an Exception if the <code>stateId</code>
does not exist in the current state cache.</p>
</div>


                            </div>
                            <div id="Client.removeStateMany" class="classattr">
                                        <input id="Client.removeStateMany-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">removeStateMany</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">states</span><span class="p">:</span> <span class="nb">list</span></span>)</span>

                <label class="view-source-button" for="Client.removeStateMany-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.removeStateMany"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.removeStateMany-362"><a href="#Client.removeStateMany-362"><span class="linenos">362</span></a>    <span class="k">def</span> <span class="nf">removeStateMany</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
</span><span id="Client.removeStateMany-363"><a href="#Client.removeStateMany-363"><span class="linenos">363</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.removeStateMany-364"><a href="#Client.removeStateMany-364"><span class="linenos">364</span></a><span class="sd">        Convenience function to remove several States at once. `states` should be an iteratable of state ID strings.</span>
</span><span id="Client.removeStateMany-365"><a href="#Client.removeStateMany-365"><span class="linenos">365</span></a><span class="sd">        This method does not validate if the states exist in the current state cache. See also: `removeState`.</span>
</span><span id="Client.removeStateMany-366"><a href="#Client.removeStateMany-366"><span class="linenos">366</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.removeStateMany-367"><a href="#Client.removeStateMany-367"><span class="linenos">367</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Client.removeStateMany-368"><a href="#Client.removeStateMany-368"><span class="linenos">368</span></a>            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
</span><span id="Client.removeStateMany-369"><a href="#Client.removeStateMany-369"><span class="linenos">369</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">removeState</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="Client.removeStateMany-370"><a href="#Client.removeStateMany-370"><span class="linenos">370</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Client.removeStateMany-371"><a href="#Client.removeStateMany-371"><span class="linenos">371</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;removeStateMany() requires an iteratable, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="si">}</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convenience function to remove several States at once. <code>states</code> should be an iteratable of state ID strings.
This method does not validate if the states exist in the current state cache. See also: <code><a href="#Client.removeState">removeState</a></code>.</p>
</div>


                            </div>
                            <div id="Client.choiceUpdate" class="classattr">
                                        <input id="Client.choiceUpdate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">choiceUpdate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">choiceId</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">values</span><span class="p">:</span> <span class="nb">list</span></span>)</span>

                <label class="view-source-button" for="Client.choiceUpdate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.choiceUpdate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.choiceUpdate-373"><a href="#Client.choiceUpdate-373"><span class="linenos">373</span></a>    <span class="k">def</span> <span class="nf">choiceUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">choiceId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
</span><span id="Client.choiceUpdate-374"><a href="#Client.choiceUpdate-374"><span class="linenos">374</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.choiceUpdate-375"><a href="#Client.choiceUpdate-375"><span class="linenos">375</span></a><span class="sd">        This updates the list of choices in a previously-declared TP State with id `stateId`.</span>
</span><span id="Client.choiceUpdate-376"><a href="#Client.choiceUpdate-376"><span class="linenos">376</span></a><span class="sd">        See TP API reference for details on updating list values.</span>
</span><span id="Client.choiceUpdate-377"><a href="#Client.choiceUpdate-377"><span class="linenos">377</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.choiceUpdate-378"><a href="#Client.choiceUpdate-378"><span class="linenos">378</span></a>        <span class="k">if</span> <span class="n">choiceId</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Client.choiceUpdate-379"><a href="#Client.choiceUpdate-379"><span class="linenos">379</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;choiceUpdate&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">choiceId</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">})</span>
</span><span id="Client.choiceUpdate-380"><a href="#Client.choiceUpdate-380"><span class="linenos">380</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">choiceUpdateList</span><span class="p">[</span><span class="n">choiceId</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
</span><span id="Client.choiceUpdate-381"><a href="#Client.choiceUpdate-381"><span class="linenos">381</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Client.choiceUpdate-382"><a href="#Client.choiceUpdate-382"><span class="linenos">382</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;choiceUpdate() values argument needs to be a list not a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This updates the list of choices in a previously-declared TP State with id <code>stateId</code>.
See TP API reference for details on updating list values.</p>
</div>


                            </div>
                            <div id="Client.choiceUpdateSpecific" class="classattr">
                                        <input id="Client.choiceUpdateSpecific-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">choiceUpdateSpecific</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">stateId</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">values</span><span class="p">:</span> <span class="nb">list</span>, </span><span class="param"><span class="n">instanceId</span><span class="p">:</span> <span class="nb">str</span></span>)</span>

                <label class="view-source-button" for="Client.choiceUpdateSpecific-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.choiceUpdateSpecific"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.choiceUpdateSpecific-384"><a href="#Client.choiceUpdateSpecific-384"><span class="linenos">384</span></a>    <span class="k">def</span> <span class="nf">choiceUpdateSpecific</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">instanceId</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
</span><span id="Client.choiceUpdateSpecific-385"><a href="#Client.choiceUpdateSpecific-385"><span class="linenos">385</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.choiceUpdateSpecific-386"><a href="#Client.choiceUpdateSpecific-386"><span class="linenos">386</span></a><span class="sd">        This updates a list of choices in a specific TP Item Instance, specified in `instanceId`.</span>
</span><span id="Client.choiceUpdateSpecific-387"><a href="#Client.choiceUpdateSpecific-387"><span class="linenos">387</span></a><span class="sd">        See TP API reference for details on updating specific instances.</span>
</span><span id="Client.choiceUpdateSpecific-388"><a href="#Client.choiceUpdateSpecific-388"><span class="linenos">388</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.choiceUpdateSpecific-389"><a href="#Client.choiceUpdateSpecific-389"><span class="linenos">389</span></a>        <span class="k">if</span> <span class="n">stateId</span> <span class="ow">and</span> <span class="n">instanceId</span><span class="p">:</span>
</span><span id="Client.choiceUpdateSpecific-390"><a href="#Client.choiceUpdateSpecific-390"><span class="linenos">390</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Client.choiceUpdateSpecific-391"><a href="#Client.choiceUpdateSpecific-391"><span class="linenos">391</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;choiceUpdate&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">stateId</span><span class="p">,</span> <span class="s2">&quot;instanceId&quot;</span><span class="p">:</span> <span class="n">instanceId</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">values</span><span class="p">})</span>
</span><span id="Client.choiceUpdateSpecific-392"><a href="#Client.choiceUpdateSpecific-392"><span class="linenos">392</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Client.choiceUpdateSpecific-393"><a href="#Client.choiceUpdateSpecific-393"><span class="linenos">393</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;choiceUpdateSpecific() values argument needs to be a list not a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This updates a list of choices in a specific TP Item Instance, specified in <code>instanceId</code>.
See TP API reference for details on updating specific instances.</p>
</div>


                            </div>
                            <div id="Client.settingUpdate" class="classattr">
                                        <input id="Client.settingUpdate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">settingUpdate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">settingName</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">settingValue</span></span>)</span>

                <label class="view-source-button" for="Client.settingUpdate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.settingUpdate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.settingUpdate-395"><a href="#Client.settingUpdate-395"><span class="linenos">395</span></a>    <span class="k">def</span> <span class="nf">settingUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settingName</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">settingValue</span><span class="p">):</span>
</span><span id="Client.settingUpdate-396"><a href="#Client.settingUpdate-396"><span class="linenos">396</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.settingUpdate-397"><a href="#Client.settingUpdate-397"><span class="linenos">397</span></a><span class="sd">        This updates a value named `settingName` in your plugin&#39;s Settings to `settingValue`.</span>
</span><span id="Client.settingUpdate-398"><a href="#Client.settingUpdate-398"><span class="linenos">398</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.settingUpdate-399"><a href="#Client.settingUpdate-399"><span class="linenos">399</span></a>        <span class="k">if</span> <span class="n">settingName</span> <span class="ow">and</span> <span class="n">settingName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentSettings</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentSettings</span><span class="p">[</span><span class="n">settingName</span><span class="p">]</span> <span class="o">!=</span> <span class="n">settingValue</span><span class="p">:</span>
</span><span id="Client.settingUpdate-400"><a href="#Client.settingUpdate-400"><span class="linenos">400</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;settingUpdate&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">settingName</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">settingValue</span><span class="p">})</span>
</span><span id="Client.settingUpdate-401"><a href="#Client.settingUpdate-401"><span class="linenos">401</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">currentSettings</span><span class="p">[</span><span class="n">settingName</span><span class="p">]</span> <span class="o">=</span> <span class="n">settingValue</span>
</span></pre></div>


            <div class="docstring"><p>This updates a value named <code>settingName</code> in your plugin's Settings to <code>settingValue</code>.</p>
</div>


                            </div>
                            <div id="Client.stateUpdate" class="classattr">
                                        <input id="Client.stateUpdate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">stateUpdate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">stateId</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">stateValue</span><span class="p">:</span> <span class="nb">str</span></span>)</span>

                <label class="view-source-button" for="Client.stateUpdate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.stateUpdate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.stateUpdate-403"><a href="#Client.stateUpdate-403"><span class="linenos">403</span></a>    <span class="k">def</span> <span class="nf">stateUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">stateValue</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
</span><span id="Client.stateUpdate-404"><a href="#Client.stateUpdate-404"><span class="linenos">404</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.stateUpdate-405"><a href="#Client.stateUpdate-405"><span class="linenos">405</span></a><span class="sd">        This updates a value in ether a pre-defined static State or a dynamic State created in runtime.</span>
</span><span id="Client.stateUpdate-406"><a href="#Client.stateUpdate-406"><span class="linenos">406</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.stateUpdate-407"><a href="#Client.stateUpdate-407"><span class="linenos">407</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__stateUpdate</span><span class="p">(</span><span class="n">stateId</span><span class="p">,</span> <span class="n">stateValue</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This updates a value in ether a pre-defined static State or a dynamic State created in runtime.</p>
</div>


                            </div>
                            <div id="Client.stateUpdateMany" class="classattr">
                                        <input id="Client.stateUpdateMany-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">stateUpdateMany</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">states</span><span class="p">:</span> <span class="nb">list</span></span>)</span>

                <label class="view-source-button" for="Client.stateUpdateMany-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.stateUpdateMany"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.stateUpdateMany-415"><a href="#Client.stateUpdateMany-415"><span class="linenos">415</span></a>    <span class="k">def</span> <span class="nf">stateUpdateMany</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
</span><span id="Client.stateUpdateMany-416"><a href="#Client.stateUpdateMany-416"><span class="linenos">416</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.stateUpdateMany-417"><a href="#Client.stateUpdateMany-417"><span class="linenos">417</span></a><span class="sd">        Convenience function to update several states at once.</span>
</span><span id="Client.stateUpdateMany-418"><a href="#Client.stateUpdateMany-418"><span class="linenos">418</span></a><span class="sd">        `states` should be an iteratable of `dict` types in the form of `{&#39;id&#39;: &quot;StateId&quot;, &#39;value&#39;: &quot;The New Value&quot;}`.</span>
</span><span id="Client.stateUpdateMany-419"><a href="#Client.stateUpdateMany-419"><span class="linenos">419</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.stateUpdateMany-420"><a href="#Client.stateUpdateMany-420"><span class="linenos">420</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Client.stateUpdateMany-421"><a href="#Client.stateUpdateMany-421"><span class="linenos">421</span></a>            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
</span><span id="Client.stateUpdateMany-422"><a href="#Client.stateUpdateMany-422"><span class="linenos">422</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="Client.stateUpdateMany-423"><a href="#Client.stateUpdateMany-423"><span class="linenos">423</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stateUpdate</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
</span><span id="Client.stateUpdateMany-424"><a href="#Client.stateUpdateMany-424"><span class="linenos">424</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Client.stateUpdateMany-425"><a href="#Client.stateUpdateMany-425"><span class="linenos">425</span></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;StateUpdateMany() requires a list of dicts, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="si">}</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
</span><span id="Client.stateUpdateMany-426"><a href="#Client.stateUpdateMany-426"><span class="linenos">426</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Client.stateUpdateMany-427"><a href="#Client.stateUpdateMany-427"><span class="linenos">427</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;StateUpdateMany() requires an iteratable, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">states</span><span class="p">)</span><span class="si">}</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convenience function to update several states at once.
<code>states</code> should be an iteratable of <code>dict</code> types in the form of <code>{'id': "StateId", 'value': "The New Value"}</code>.</p>
</div>


                            </div>
                            <div id="Client.showNotification" class="classattr">
                                        <input id="Client.showNotification-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">showNotification</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">notificationId</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">title</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">msg</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">options</span><span class="p">:</span> <span class="nb">list</span></span>)</span>

                <label class="view-source-button" for="Client.showNotification-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.showNotification"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.showNotification-429"><a href="#Client.showNotification-429"><span class="linenos">429</span></a>    <span class="k">def</span> <span class="nf">showNotification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">notificationId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
</span><span id="Client.showNotification-430"><a href="#Client.showNotification-430"><span class="linenos">430</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.showNotification-431"><a href="#Client.showNotification-431"><span class="linenos">431</span></a><span class="sd">        This method allows your plugin to send a notification to Touch Portal with custom title, message body and available user action(s).</span>
</span><span id="Client.showNotification-432"><a href="#Client.showNotification-432"><span class="linenos">432</span></a><span class="sd">        Requires TP SDK v4.0 or higher.</span>
</span><span id="Client.showNotification-433"><a href="#Client.showNotification-433"><span class="linenos">433</span></a>
</span><span id="Client.showNotification-434"><a href="#Client.showNotification-434"><span class="linenos">434</span></a><span class="sd">        Args:</span>
</span><span id="Client.showNotification-435"><a href="#Client.showNotification-435"><span class="linenos">435</span></a><span class="sd">            `notificationId`: Unique ID of this notification.</span>
</span><span id="Client.showNotification-436"><a href="#Client.showNotification-436"><span class="linenos">436</span></a><span class="sd">            `title`: The notification title.</span>
</span><span id="Client.showNotification-437"><a href="#Client.showNotification-437"><span class="linenos">437</span></a><span class="sd">            `msg`: The message body text that is shown in the notifcation.</span>
</span><span id="Client.showNotification-438"><a href="#Client.showNotification-438"><span class="linenos">438</span></a><span class="sd">            `options`: List of options (actions) for the notification. Each option should be a `dict` type with `id` and `title` keys.</span>
</span><span id="Client.showNotification-439"><a href="#Client.showNotification-439"><span class="linenos">439</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.showNotification-440"><a href="#Client.showNotification-440"><span class="linenos">440</span></a>        <span class="k">if</span> <span class="n">notificationId</span> <span class="ow">and</span> <span class="n">title</span> <span class="ow">and</span> <span class="n">msg</span> <span class="ow">and</span> <span class="n">options</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Client.showNotification-441"><a href="#Client.showNotification-441"><span class="linenos">441</span></a>            <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
</span><span id="Client.showNotification-442"><a href="#Client.showNotification-442"><span class="linenos">442</span></a>                <span class="k">if</span> <span class="s1">&#39;id&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">option</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;title&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">option</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Client.showNotification-443"><a href="#Client.showNotification-443"><span class="linenos">443</span></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;all options require id and title keys&quot;</span><span class="p">)</span>
</span><span id="Client.showNotification-444"><a href="#Client.showNotification-444"><span class="linenos">444</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span>
</span><span id="Client.showNotification-445"><a href="#Client.showNotification-445"><span class="linenos">445</span></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;showNotification&quot;</span><span class="p">,</span>
</span><span id="Client.showNotification-446"><a href="#Client.showNotification-446"><span class="linenos">446</span></a>                <span class="s2">&quot;notificationId&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">notificationId</span><span class="p">),</span>
</span><span id="Client.showNotification-447"><a href="#Client.showNotification-447"><span class="linenos">447</span></a>                <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">),</span>
</span><span id="Client.showNotification-448"><a href="#Client.showNotification-448"><span class="linenos">448</span></a>                <span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span>
</span><span id="Client.showNotification-449"><a href="#Client.showNotification-449"><span class="linenos">449</span></a>                <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="n">options</span>
</span><span id="Client.showNotification-450"><a href="#Client.showNotification-450"><span class="linenos">450</span></a>            <span class="p">})</span>
</span></pre></div>


            <div class="docstring"><p>This method allows your plugin to send a notification to Touch Portal with custom title, message body and available user action(s).
Requires TP SDK v4.0 or higher.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong><code>notificationId</code>:</strong>  Unique ID of this notification.</li>
<li><strong><code>title</code>:</strong>  The notification title.</li>
<li><strong><code>msg</code>:</strong>  The message body text that is shown in the notifcation.</li>
<li><strong><code>options</code>:</strong>  List of options (actions) for the notification. Each option should be a <code>dict</code> type with <code>id</code> and <code>title</code> keys.</li>
</ul>
</div>


                            </div>
                            <div id="Client.shortIdUpdate" class="classattr">
                                        <input id="Client.shortIdUpdate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">shortIdUpdate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">shortId</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">connectorValue</span><span class="p">:</span> <span class="nb">int</span></span>)</span>

                <label class="view-source-button" for="Client.shortIdUpdate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.shortIdUpdate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.shortIdUpdate-452"><a href="#Client.shortIdUpdate-452"><span class="linenos">452</span></a>    <span class="k">def</span> <span class="nf">shortIdUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shortId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">connectorValue</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="Client.shortIdUpdate-453"><a href="#Client.shortIdUpdate-453"><span class="linenos">453</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.shortIdUpdate-454"><a href="#Client.shortIdUpdate-454"><span class="linenos">454</span></a><span class="sd">        This allows you to update slider position value using shortId which TouchPortal will broadcast.</span>
</span><span id="Client.shortIdUpdate-455"><a href="#Client.shortIdUpdate-455"><span class="linenos">455</span></a>
</span><span id="Client.shortIdUpdate-456"><a href="#Client.shortIdUpdate-456"><span class="linenos">456</span></a><span class="sd">        Args:</span>
</span><span id="Client.shortIdUpdate-457"><a href="#Client.shortIdUpdate-457"><span class="linenos">457</span></a><span class="sd">            `shortId`: a shortId is a id that is mapped to connectorId by TouchPortal</span>
</span><span id="Client.shortIdUpdate-458"><a href="#Client.shortIdUpdate-458"><span class="linenos">458</span></a><span class="sd">            `connectorValue`: A integer between 0-100</span>
</span><span id="Client.shortIdUpdate-459"><a href="#Client.shortIdUpdate-459"><span class="linenos">459</span></a>
</span><span id="Client.shortIdUpdate-460"><a href="#Client.shortIdUpdate-460"><span class="linenos">460</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.shortIdUpdate-461"><a href="#Client.shortIdUpdate-461"><span class="linenos">461</span></a>        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">connectorValue</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">:</span>
</span><span id="Client.shortIdUpdate-462"><a href="#Client.shortIdUpdate-462"><span class="linenos">462</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span>
</span><span id="Client.shortIdUpdate-463"><a href="#Client.shortIdUpdate-463"><span class="linenos">463</span></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;connectorUpdate&quot;</span><span class="p">,</span>
</span><span id="Client.shortIdUpdate-464"><a href="#Client.shortIdUpdate-464"><span class="linenos">464</span></a>                <span class="s2">&quot;shortId&quot;</span><span class="p">:</span> <span class="n">shortId</span><span class="p">,</span>
</span><span id="Client.shortIdUpdate-465"><a href="#Client.shortIdUpdate-465"><span class="linenos">465</span></a>                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">connectorValue</span><span class="p">)</span>
</span><span id="Client.shortIdUpdate-466"><a href="#Client.shortIdUpdate-466"><span class="linenos">466</span></a>            <span class="p">})</span>
</span></pre></div>


            <div class="docstring"><p>This allows you to update slider position value using shortId which TouchPortal will broadcast.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong><code>shortId</code>:</strong>  a shortId is a id that is mapped to connectorId by TouchPortal</li>
<li><strong><code>connectorValue</code>:</strong>  A integer between 0-100</li>
</ul>
</div>


                            </div>
                            <div id="Client.connectorUpdate" class="classattr">
                                        <input id="Client.connectorUpdate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">connectorUpdate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">connectorId</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">connectorValue</span><span class="p">:</span> <span class="nb">int</span></span>)</span>

                <label class="view-source-button" for="Client.connectorUpdate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.connectorUpdate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.connectorUpdate-468"><a href="#Client.connectorUpdate-468"><span class="linenos">468</span></a>    <span class="k">def</span> <span class="nf">connectorUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connectorId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">connectorValue</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
</span><span id="Client.connectorUpdate-469"><a href="#Client.connectorUpdate-469"><span class="linenos">469</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.connectorUpdate-470"><a href="#Client.connectorUpdate-470"><span class="linenos">470</span></a><span class="sd">        This allows you to update slider position value.</span>
</span><span id="Client.connectorUpdate-471"><a href="#Client.connectorUpdate-471"><span class="linenos">471</span></a>
</span><span id="Client.connectorUpdate-472"><a href="#Client.connectorUpdate-472"><span class="linenos">472</span></a><span class="sd">        Args:</span>
</span><span id="Client.connectorUpdate-473"><a href="#Client.connectorUpdate-473"><span class="linenos">473</span></a><span class="sd">            `connectorId`: Cannot be longer then 200 characters.</span>
</span><span id="Client.connectorUpdate-474"><a href="#Client.connectorUpdate-474"><span class="linenos">474</span></a><span class="sd">                connectorId have syntax that you need to follow https://www.touch-portal.com/api/index.php?section=connectors</span>
</span><span id="Client.connectorUpdate-475"><a href="#Client.connectorUpdate-475"><span class="linenos">475</span></a><span class="sd">                Also according to that site It requires you to have prefix &quot;pc_yourPluginId_&quot; + connectorid however This already provide</span>
</span><span id="Client.connectorUpdate-476"><a href="#Client.connectorUpdate-476"><span class="linenos">476</span></a><span class="sd">                you the prefix and the pluginId so you just need you take care the rest eg connectorid|setting1=aValue</span>
</span><span id="Client.connectorUpdate-477"><a href="#Client.connectorUpdate-477"><span class="linenos">477</span></a><span class="sd">            `connectorValue`: Must be an integer between 0-100.</span>
</span><span id="Client.connectorUpdate-478"><a href="#Client.connectorUpdate-478"><span class="linenos">478</span></a>
</span><span id="Client.connectorUpdate-479"><a href="#Client.connectorUpdate-479"><span class="linenos">479</span></a><span class="sd">        Note: This method will automatically looking for shortId using gaven connectorId however if It cannot find shortId it will just send connectorId</span>
</span><span id="Client.connectorUpdate-480"><a href="#Client.connectorUpdate-480"><span class="linenos">480</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.connectorUpdate-481"><a href="#Client.connectorUpdate-481"><span class="linenos">481</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">connectorId</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Client.connectorUpdate-482"><a href="#Client.connectorUpdate-482"><span class="linenos">482</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;connectorId needs to be a str not a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">connectorId</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Client.connectorUpdate-483"><a href="#Client.connectorUpdate-483"><span class="linenos">483</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">connectorValue</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Client.connectorUpdate-484"><a href="#Client.connectorUpdate-484"><span class="linenos">484</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;connectorValue requires a int not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">connectorValue</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Client.connectorUpdate-485"><a href="#Client.connectorUpdate-485"><span class="linenos">485</span></a>        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">connectorValue</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">:</span>
</span><span id="Client.connectorUpdate-486"><a href="#Client.connectorUpdate-486"><span class="linenos">486</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">cid</span> <span class="o">:=</span> <span class="sa">f</span><span class="s2">&quot;pc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pluginId</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">connectorId</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shortIdTracker</span><span class="p">:</span>
</span><span id="Client.connectorUpdate-487"><a href="#Client.connectorUpdate-487"><span class="linenos">487</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">shortIdUpdate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shortIdTracker</span><span class="p">[</span><span class="n">cid</span><span class="p">],</span> <span class="n">connectorValue</span><span class="p">)</span>
</span><span id="Client.connectorUpdate-488"><a href="#Client.connectorUpdate-488"><span class="linenos">488</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Client.connectorUpdate-489"><a href="#Client.connectorUpdate-489"><span class="linenos">489</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span>
</span><span id="Client.connectorUpdate-490"><a href="#Client.connectorUpdate-490"><span class="linenos">490</span></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;connectorUpdate&quot;</span><span class="p">,</span>
</span><span id="Client.connectorUpdate-491"><a href="#Client.connectorUpdate-491"><span class="linenos">491</span></a>                    <span class="s2">&quot;connectorId&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;pc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pluginId</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">connectorId</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="Client.connectorUpdate-492"><a href="#Client.connectorUpdate-492"><span class="linenos">492</span></a>                    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">connectorValue</span><span class="p">)</span>
</span><span id="Client.connectorUpdate-493"><a href="#Client.connectorUpdate-493"><span class="linenos">493</span></a>                <span class="p">})</span>
</span><span id="Client.connectorUpdate-494"><a href="#Client.connectorUpdate-494"><span class="linenos">494</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Client.connectorUpdate-495"><a href="#Client.connectorUpdate-495"><span class="linenos">495</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;connectorValue needs to be between 0-100 not </span><span class="si">{</span><span class="n">connectorValue</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This allows you to update slider position value.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong><code>connectorId</code>:</strong>  Cannot be longer then 200 characters.
connectorId have syntax that you need to follow https://www.touch-portal.com/api/index.php?section=connectors
Also according to that site It requires you to have prefix "pc_yourPluginId_" + connectorid however This already provide
you the prefix and the pluginId so you just need you take care the rest eg connectorid|setting1=aValue</li>
<li><strong><code>connectorValue</code>:</strong>  Must be an integer between 0-100.</li>
</ul>

<p>Note: This method will automatically looking for shortId using gaven connectorId however if It cannot find shortId it will just send connectorId</p>
</div>


                            </div>
                            <div id="Client.updateActionData" class="classattr">
                                        <input id="Client.updateActionData-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">updateActionData</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">instanceId</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">stateId</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">minValue</span>, </span><span class="param"><span class="n">maxValue</span></span>)</span>

                <label class="view-source-button" for="Client.updateActionData-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.updateActionData"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.updateActionData-497"><a href="#Client.updateActionData-497"><span class="linenos">497</span></a>    <span class="k">def</span> <span class="nf">updateActionData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instanceId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">stateId</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">minValue</span><span class="p">,</span> <span class="n">maxValue</span><span class="p">):</span>
</span><span id="Client.updateActionData-498"><a href="#Client.updateActionData-498"><span class="linenos">498</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.updateActionData-499"><a href="#Client.updateActionData-499"><span class="linenos">499</span></a><span class="sd">        This allows you to update Action Data in one of your Action. Currently TouchPortal only supports changing the minimum and maximum values in numeric data types.</span>
</span><span id="Client.updateActionData-500"><a href="#Client.updateActionData-500"><span class="linenos">500</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.updateActionData-501"><a href="#Client.updateActionData-501"><span class="linenos">501</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;updateActionData&quot;</span><span class="p">,</span> <span class="s2">&quot;instanceId&quot;</span><span class="p">:</span> <span class="n">instanceId</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;minValue&quot;</span><span class="p">:</span> <span class="n">minValue</span><span class="p">,</span> <span class="s2">&quot;maxValue&quot;</span><span class="p">:</span> <span class="n">maxValue</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">stateId</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">}})</span>
</span></pre></div>


            <div class="docstring"><p>This allows you to update Action Data in one of your Action. Currently TouchPortal only supports changing the minimum and maximum values in numeric data types.</p>
</div>


                            </div>
                            <div id="Client.getChoiceUpdatelist" class="classattr">
                                        <input id="Client.getChoiceUpdatelist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getChoiceUpdatelist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="Client.getChoiceUpdatelist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.getChoiceUpdatelist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.getChoiceUpdatelist-503"><a href="#Client.getChoiceUpdatelist-503"><span class="linenos">503</span></a>    <span class="k">def</span> <span class="nf">getChoiceUpdatelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client.getChoiceUpdatelist-504"><a href="#Client.getChoiceUpdatelist-504"><span class="linenos">504</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.getChoiceUpdatelist-505"><a href="#Client.getChoiceUpdatelist-505"><span class="linenos">505</span></a><span class="sd">        This will return a dict that `choiceUpdate` registered.</span>
</span><span id="Client.getChoiceUpdatelist-506"><a href="#Client.getChoiceUpdatelist-506"><span class="linenos">506</span></a><span class="sd">            example return value `{&quot;choiceUpdateid1&quot;: [&quot;item1&quot;, &quot;item2&quot;, &quot;item3&quot;], &quot;exampleChoiceId&quot;: [&quot;Option1&quot;, &quot;Option2&quot;, &quot;Option3&quot;]}`</span>
</span><span id="Client.getChoiceUpdatelist-507"><a href="#Client.getChoiceUpdatelist-507"><span class="linenos">507</span></a>
</span><span id="Client.getChoiceUpdatelist-508"><a href="#Client.getChoiceUpdatelist-508"><span class="linenos">508</span></a><span class="sd">        You should use this to verify before Updating the choice list    </span>
</span><span id="Client.getChoiceUpdatelist-509"><a href="#Client.getChoiceUpdatelist-509"><span class="linenos">509</span></a><span class="sd">        **Note** This is the same as TPClient.choiceUpdateList variable *DO NOT MODIFY* TPClient.choiceUpdateList unless you know what your doing</span>
</span><span id="Client.getChoiceUpdatelist-510"><a href="#Client.getChoiceUpdatelist-510"><span class="linenos">510</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.getChoiceUpdatelist-511"><a href="#Client.getChoiceUpdatelist-511"><span class="linenos">511</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">choiceUpdateList</span>
</span></pre></div>


            <div class="docstring"><p>This will return a dict that <code><a href="#Client.choiceUpdate">choiceUpdate</a></code> registered.
    example return value <code>{"choiceUpdateid1": ["item1", "item2", "item3"], "exampleChoiceId": ["Option1", "Option2", "Option3"]}</code></p>

<p>You should use this to verify before Updating the choice list <br />
<strong>Note</strong> This is the same as TPClient.choiceUpdateList variable <em>DO NOT MODIFY</em> TPClient.choiceUpdateList unless you know what your doing</p>
</div>


                            </div>
                            <div id="Client.getStatelist" class="classattr">
                                        <input id="Client.getStatelist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getStatelist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="Client.getStatelist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.getStatelist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.getStatelist-513"><a href="#Client.getStatelist-513"><span class="linenos">513</span></a>    <span class="k">def</span> <span class="nf">getStatelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client.getStatelist-514"><a href="#Client.getStatelist-514"><span class="linenos">514</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.getStatelist-515"><a href="#Client.getStatelist-515"><span class="linenos">515</span></a><span class="sd">        This will return a dict that have key pair of states that you last updated.</span>
</span><span id="Client.getStatelist-516"><a href="#Client.getStatelist-516"><span class="linenos">516</span></a><span class="sd">            Example retun value `{&quot;stateId1&quot;: &quot;value1&quot;, &quot;stateId2&quot;: &quot;value2&quot;, &quot;stateId3&quot;: &quot;value3&quot;}`</span>
</span><span id="Client.getStatelist-517"><a href="#Client.getStatelist-517"><span class="linenos">517</span></a><span class="sd">        This is used to keep track of all states. It will be automatically updated when you update states</span>
</span><span id="Client.getStatelist-518"><a href="#Client.getStatelist-518"><span class="linenos">518</span></a><span class="sd">        **Note** This is the same as TPClient.currentState variable *DO NOT MODIFY* TPClient.currentState unless you know what your doing</span>
</span><span id="Client.getStatelist-519"><a href="#Client.getStatelist-519"><span class="linenos">519</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.getStatelist-520"><a href="#Client.getStatelist-520"><span class="linenos">520</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentStates</span>
</span></pre></div>


            <div class="docstring"><p>This will return a dict that have key pair of states that you last updated.
    Example retun value <code>{"stateId1": "value1", "stateId2": "value2", "stateId3": "value3"}</code>
This is used to keep track of all states. It will be automatically updated when you update states
<strong>Note</strong> This is the same as TPClient.currentState variable <em>DO NOT MODIFY</em> TPClient.currentState unless you know what your doing</p>
</div>


                            </div>
                            <div id="Client.getSettinghistory" class="classattr">
                                        <input id="Client.getSettinghistory-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getSettinghistory</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="Client.getSettinghistory-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.getSettinghistory"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.getSettinghistory-522"><a href="#Client.getSettinghistory-522"><span class="linenos">522</span></a>    <span class="k">def</span> <span class="nf">getSettinghistory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client.getSettinghistory-523"><a href="#Client.getSettinghistory-523"><span class="linenos">523</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.getSettinghistory-524"><a href="#Client.getSettinghistory-524"><span class="linenos">524</span></a><span class="sd">        This will return a dict that have key pair of setting value that you updated previously.</span>
</span><span id="Client.getSettinghistory-525"><a href="#Client.getSettinghistory-525"><span class="linenos">525</span></a>
</span><span id="Client.getSettinghistory-526"><a href="#Client.getSettinghistory-526"><span class="linenos">526</span></a><span class="sd">        This is used to track settings value that you have updated previously </span>
</span><span id="Client.getSettinghistory-527"><a href="#Client.getSettinghistory-527"><span class="linenos">527</span></a><span class="sd">        **Note** This is the same as TPClient.currentSettings variable *DO NOT MODIFY* TPClient.currentSettings unless you know what your doing</span>
</span><span id="Client.getSettinghistory-528"><a href="#Client.getSettinghistory-528"><span class="linenos">528</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.getSettinghistory-529"><a href="#Client.getSettinghistory-529"><span class="linenos">529</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentSettings</span>
</span></pre></div>


            <div class="docstring"><p>This will return a dict that have key pair of setting value that you updated previously.</p>

<p>This is used to track settings value that you have updated previously 
<strong>Note</strong> This is the same as TPClient.currentSettings variable <em>DO NOT MODIFY</em> TPClient.currentSettings unless you know what your doing</p>
</div>


                            </div>
                            <div id="Client.send" class="classattr">
                                        <input id="Client.send-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">send</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">data</span></span>)</span>

                <label class="view-source-button" for="Client.send-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.send"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.send-531"><a href="#Client.send-531"><span class="linenos">531</span></a>    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="Client.send-532"><a href="#Client.send-532"><span class="linenos">532</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.send-533"><a href="#Client.send-533"><span class="linenos">533</span></a><span class="sd">        This will try to send any arbitrary Python object in `data` (presumably something `dict`-like) to Touch Portal</span>
</span><span id="Client.send-534"><a href="#Client.send-534"><span class="linenos">534</span></a><span class="sd">        after serializing it as JSON and adding a `\n`. Normally there is no need to use this method directly, but if the</span>
</span><span id="Client.send-535"><a href="#Client.send-535"><span class="linenos">535</span></a><span class="sd">        Python API doesn&#39;t cover something from the TP API, this could be used instead.</span>
</span><span id="Client.send-536"><a href="#Client.send-536"><span class="linenos">536</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.send-537"><a href="#Client.send-537"><span class="linenos">537</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getWriteLock</span><span class="p">():</span>
</span><span id="Client.send-538"><a href="#Client.send-538"><span class="linenos">538</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SND_BUFFER_SZ</span><span class="p">:</span>
</span><span id="Client.send-539"><a href="#Client.send-539"><span class="linenos">539</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="Client.send-540"><a href="#Client.send-540"><span class="linenos">540</span></a>                <span class="k">raise</span> <span class="ne">ResourceWarning</span><span class="p">(</span><span class="s2">&quot;TP Client send buffer is full!&quot;</span><span class="p">)</span>
</span><span id="Client.send-541"><a href="#Client.send-541"><span class="linenos">541</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__sendBuffer</span> <span class="o">+=</span> <span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span><span id="Client.send-542"><a href="#Client.send-542"><span class="linenos">542</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__writeLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="Client.send-543"><a href="#Client.send-543"><span class="linenos">543</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__dataReadyEvent</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>This will try to send any arbitrary Python object in <code>data</code> (presumably something <code>dict</code>-like) to Touch Portal
        after serializing it as JSON and adding a <code>
</code>. Normally there is no need to use this method directly, but if the
        Python API doesn't cover something from the TP API, this could be used instead.</p>
</div>


                            </div>
                            <div id="Client.connect" class="classattr">
                                        <input id="Client.connect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">connect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="Client.connect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.connect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.connect-545"><a href="#Client.connect-545"><span class="linenos">545</span></a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client.connect-546"><a href="#Client.connect-546"><span class="linenos">546</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.connect-547"><a href="#Client.connect-547"><span class="linenos">547</span></a><span class="sd">        Initiate connection to TP Server.</span>
</span><span id="Client.connect-548"><a href="#Client.connect-548"><span class="linenos">548</span></a><span class="sd">        If successful, it starts the main processing loop of this client.</span>
</span><span id="Client.connect-549"><a href="#Client.connect-549"><span class="linenos">549</span></a><span class="sd">        Does nothing if client is already connected.</span>
</span><span id="Client.connect-550"><a href="#Client.connect-550"><span class="linenos">550</span></a>
</span><span id="Client.connect-551"><a href="#Client.connect-551"><span class="linenos">551</span></a><span class="sd">        **Note** that `connect()` blocks further execution of your script until one of the following occurs:</span>
</span><span id="Client.connect-552"><a href="#Client.connect-552"><span class="linenos">552</span></a><span class="sd">          - `disconnect()` is called in an event handler,</span>
</span><span id="Client.connect-553"><a href="#Client.connect-553"><span class="linenos">553</span></a><span class="sd">          - TP sends `closePlugin` message and `autoClose` is `True`</span>
</span><span id="Client.connect-554"><a href="#Client.connect-554"><span class="linenos">554</span></a><span class="sd">          - or an internal error occurs (for example Touch Portal disconnects unexpectedly)</span>
</span><span id="Client.connect-555"><a href="#Client.connect-555"><span class="linenos">555</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.connect-556"><a href="#Client.connect-556"><span class="linenos">556</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isConnected</span><span class="p">():</span>
</span><span id="Client.connect-557"><a href="#Client.connect-557"><span class="linenos">557</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__open</span><span class="p">()</span>
</span><span id="Client.connect-558"><a href="#Client.connect-558"><span class="linenos">558</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;pair&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pluginId</span><span class="p">})</span>
</span><span id="Client.connect-559"><a href="#Client.connect-559"><span class="linenos">559</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">()</span>  <span class="c1"># start the event loop</span>
</span></pre></div>


            <div class="docstring"><p>Initiate connection to TP Server.
If successful, it starts the main processing loop of this client.
Does nothing if client is already connected.</p>

<p><strong>Note</strong> that <code><a href="#Client.connect">connect()</a></code> blocks further execution of your script until one of the following occurs:</p>

<ul>
<li><code><a href="#Client.disconnect">disconnect()</a></code> is called in an event handler,</li>
<li>TP sends <code>closePlugin</code> message and <code>autoClose</code> is <code>True</code></li>
<li>or an internal error occurs (for example Touch Portal disconnects unexpectedly)</li>
</ul>
</div>


                            </div>
                            <div id="Client.disconnect" class="classattr">
                                        <input id="Client.disconnect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">disconnect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="Client.disconnect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.disconnect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.disconnect-561"><a href="#Client.disconnect-561"><span class="linenos">561</span></a>    <span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Client.disconnect-562"><a href="#Client.disconnect-562"><span class="linenos">562</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.disconnect-563"><a href="#Client.disconnect-563"><span class="linenos">563</span></a><span class="sd">        This closes the connection to TP and terminates the client processing loop.</span>
</span><span id="Client.disconnect-564"><a href="#Client.disconnect-564"><span class="linenos">564</span></a><span class="sd">        Does nothing if client is already disconnected.</span>
</span><span id="Client.disconnect-565"><a href="#Client.disconnect-565"><span class="linenos">565</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.disconnect-566"><a href="#Client.disconnect-566"><span class="linenos">566</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isConnected</span><span class="p">():</span>
</span><span id="Client.disconnect-567"><a href="#Client.disconnect-567"><span class="linenos">567</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__close</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>This closes the connection to TP and terminates the client processing loop.
Does nothing if client is already disconnected.</p>
</div>


                            </div>
                            <div id="Client.getActionDataValue" class="classattr">
                                        <input id="Client.getActionDataValue-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">getActionDataValue</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span><span class="p">:</span> <span class="nb">list</span>, </span><span class="param"><span class="n">valueId</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Client.getActionDataValue-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Client.getActionDataValue"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Client.getActionDataValue-569"><a href="#Client.getActionDataValue-569"><span class="linenos">569</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Client.getActionDataValue-570"><a href="#Client.getActionDataValue-570"><span class="linenos">570</span></a>    <span class="k">def</span> <span class="nf">getActionDataValue</span><span class="p">(</span><span class="n">data</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">valueId</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Client.getActionDataValue-571"><a href="#Client.getActionDataValue-571"><span class="linenos">571</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Client.getActionDataValue-572"><a href="#Client.getActionDataValue-572"><span class="linenos">572</span></a><span class="sd">        Utility for processing action messages from TP. For example:</span>
</span><span id="Client.getActionDataValue-573"><a href="#Client.getActionDataValue-573"><span class="linenos">573</span></a><span class="sd">            {&quot;type&quot;: &quot;action&quot;, &quot;data&quot;: [{ &quot;id&quot;: &quot;data object id&quot;, &quot;value&quot;: &quot;user specified value&quot; }, ...]}</span>
</span><span id="Client.getActionDataValue-574"><a href="#Client.getActionDataValue-574"><span class="linenos">574</span></a>
</span><span id="Client.getActionDataValue-575"><a href="#Client.getActionDataValue-575"><span class="linenos">575</span></a><span class="sd">        Returns the `value` with specific `id` from a list of action data,</span>
</span><span id="Client.getActionDataValue-576"><a href="#Client.getActionDataValue-576"><span class="linenos">576</span></a><span class="sd">        or `None` if the `id` wasn&#39;t found. If a null id is passed in `valueId`</span>
</span><span id="Client.getActionDataValue-577"><a href="#Client.getActionDataValue-577"><span class="linenos">577</span></a><span class="sd">        then the first entry which has a `value` key, if any, will be returned.</span>
</span><span id="Client.getActionDataValue-578"><a href="#Client.getActionDataValue-578"><span class="linenos">578</span></a>
</span><span id="Client.getActionDataValue-579"><a href="#Client.getActionDataValue-579"><span class="linenos">579</span></a><span class="sd">        Args:</span>
</span><span id="Client.getActionDataValue-580"><a href="#Client.getActionDataValue-580"><span class="linenos">580</span></a><span class="sd">            `data`: the &quot;data&quot; array from a TP &quot;action&quot;, &quot;on&quot;, or &quot;off&quot; message</span>
</span><span id="Client.getActionDataValue-581"><a href="#Client.getActionDataValue-581"><span class="linenos">581</span></a><span class="sd">            `valueId`: the &quot;id&quot; to look for in `data`. `None` or blank to return the first value found.</span>
</span><span id="Client.getActionDataValue-582"><a href="#Client.getActionDataValue-582"><span class="linenos">582</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Client.getActionDataValue-583"><a href="#Client.getActionDataValue-583"><span class="linenos">583</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
</span><span id="Client.getActionDataValue-584"><a href="#Client.getActionDataValue-584"><span class="linenos">584</span></a>        <span class="k">if</span> <span class="n">valueId</span><span class="p">:</span>
</span><span id="Client.getActionDataValue-585"><a href="#Client.getActionDataValue-585"><span class="linenos">585</span></a>            <span class="k">return</span> <span class="nb">next</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">valueId</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="Client.getActionDataValue-586"><a href="#Client.getActionDataValue-586"><span class="linenos">586</span></a>        <span class="k">return</span> <span class="nb">next</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Utility for processing action messages from TP. For example:
    {"type": "action", "data": [{ "id": "data object id", "value": "user specified value" }, ...]}</p>

<p>Returns the <code>value</code> with specific <code>id</code> from a list of action data,
or <code>None</code> if the <code>id</code> wasn't found. If a null id is passed in <code>valueId</code>
then the first entry which has a <code>value</code> key, if any, will be returned.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong><code>data</code>:</strong>  the "data" array from a TP "action", "on", or "off" message</li>
<li><strong><code>valueId</code>:</strong>  the "id" to look for in <code>data</code>. <code>None</code> or blank to return the first value found.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>pyee._executor.ExecutorEventEmitter</dt>
                                <dd id="Client.shutdown" class="function">shutdown</dd>

            </div>
            <div><dt>pyee._base.EventEmitter</dt>
                                <dd id="Client.on" class="function">on</dd>
                <dd id="Client.emit" class="function">emit</dd>
                <dd id="Client.once" class="function">once</dd>
                <dd id="Client.remove_listener" class="function">remove_listener</dd>
                <dd id="Client.remove_all_listeners" class="function">remove_all_listeners</dd>
                <dd id="Client.listeners" class="function">listeners</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TYPES">
                            <input id="TYPES-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TYPES</span>:

                <label class="view-source-button" for="TYPES-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TYPES"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TYPES-30"><a href="#TYPES-30"><span class="linenos">30</span></a><span class="k">class</span> <span class="nc">TYPES</span><span class="p">:</span>
</span><span id="TYPES-31"><a href="#TYPES-31"><span class="linenos">31</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="TYPES-32"><a href="#TYPES-32"><span class="linenos">32</span></a><span class="sd">    Event type enumerations. These correspond to the message types Touch Portal may send.</span>
</span><span id="TYPES-33"><a href="#TYPES-33"><span class="linenos">33</span></a><span class="sd">    Event handler callbacks receive one parameter, which is the JSON data structure sent</span>
</span><span id="TYPES-34"><a href="#TYPES-34"><span class="linenos">34</span></a><span class="sd">    from TP and then converted to a corresponding Python object using `json.loads()`.</span>
</span><span id="TYPES-35"><a href="#TYPES-35"><span class="linenos">35</span></a><span class="sd">    Usage example:</span>
</span><span id="TYPES-36"><a href="#TYPES-36"><span class="linenos">36</span></a><span class="sd">        ```py</span>
</span><span id="TYPES-37"><a href="#TYPES-37"><span class="linenos">37</span></a><span class="sd">        import TouchPortalAPI as TP</span>
</span><span id="TYPES-38"><a href="#TYPES-38"><span class="linenos">38</span></a>
</span><span id="TYPES-39"><a href="#TYPES-39"><span class="linenos">39</span></a><span class="sd">        client = TP.Client(&quot;myplugin&quot;)</span>
</span><span id="TYPES-40"><a href="#TYPES-40"><span class="linenos">40</span></a>
</span><span id="TYPES-41"><a href="#TYPES-41"><span class="linenos">41</span></a><span class="sd">        @client.on(TP.TYPES.onConnect)</span>
</span><span id="TYPES-42"><a href="#TYPES-42"><span class="linenos">42</span></a><span class="sd">        # equivalent to: @client.on(&#39;info&#39;)</span>
</span><span id="TYPES-43"><a href="#TYPES-43"><span class="linenos">43</span></a><span class="sd">        def onConnect(data):</span>
</span><span id="TYPES-44"><a href="#TYPES-44"><span class="linenos">44</span></a><span class="sd">            print(data)</span>
</span><span id="TYPES-45"><a href="#TYPES-45"><span class="linenos">45</span></a>
</span><span id="TYPES-46"><a href="#TYPES-46"><span class="linenos">46</span></a><span class="sd">        # alternatively, w/out decorators:</span>
</span><span id="TYPES-47"><a href="#TYPES-47"><span class="linenos">47</span></a><span class="sd">        def onAction(data):</span>
</span><span id="TYPES-48"><a href="#TYPES-48"><span class="linenos">48</span></a><span class="sd">            print(data)</span>
</span><span id="TYPES-49"><a href="#TYPES-49"><span class="linenos">49</span></a>
</span><span id="TYPES-50"><a href="#TYPES-50"><span class="linenos">50</span></a><span class="sd">        client.on(TP.TYPES.onAction, onAction)</span>
</span><span id="TYPES-51"><a href="#TYPES-51"><span class="linenos">51</span></a><span class="sd">        ```</span>
</span><span id="TYPES-52"><a href="#TYPES-52"><span class="linenos">52</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TYPES-53"><a href="#TYPES-53"><span class="linenos">53</span></a>    <span class="n">onHold_up</span> <span class="o">=</span> <span class="s1">&#39;up&#39;</span>
</span><span id="TYPES-54"><a href="#TYPES-54"><span class="linenos">54</span></a>    <span class="sd">&quot;&quot;&quot; When the action is used in a hold functionality and the user releases the Touch Portal button (Api 3.0+) &quot;&quot;&quot;</span>
</span><span id="TYPES-55"><a href="#TYPES-55"><span class="linenos">55</span></a>    <span class="n">onHold_down</span> <span class="o">=</span> <span class="s1">&#39;down&#39;</span>
</span><span id="TYPES-56"><a href="#TYPES-56"><span class="linenos">56</span></a>    <span class="sd">&quot;&quot;&quot; When the action is used in a hold functionality and the user presses the Touch Portal button down (Api 3.0+) &quot;&quot;&quot;</span>
</span><span id="TYPES-57"><a href="#TYPES-57"><span class="linenos">57</span></a>    <span class="n">onConnect</span> <span class="o">=</span> <span class="s1">&#39;info&#39;</span>
</span><span id="TYPES-58"><a href="#TYPES-58"><span class="linenos">58</span></a>    <span class="sd">&quot;&quot;&quot; Info message returned after successful pairing. &quot;&quot;&quot;</span>
</span><span id="TYPES-59"><a href="#TYPES-59"><span class="linenos">59</span></a>    <span class="n">onAction</span> <span class="o">=</span> <span class="s1">&#39;action&#39;</span>
</span><span id="TYPES-60"><a href="#TYPES-60"><span class="linenos">60</span></a>    <span class="sd">&quot;&quot;&quot; When actions are triggered by the user (Api 1.0+) &quot;&quot;&quot;</span>
</span><span id="TYPES-61"><a href="#TYPES-61"><span class="linenos">61</span></a>    <span class="n">onListChange</span> <span class="o">=</span> <span class="s1">&#39;listChange&#39;</span>
</span><span id="TYPES-62"><a href="#TYPES-62"><span class="linenos">62</span></a>    <span class="sd">&quot;&quot;&quot; When a user makes a change in one of your lists (Api 1.0+) &quot;&quot;&quot;</span>
</span><span id="TYPES-63"><a href="#TYPES-63"><span class="linenos">63</span></a>    <span class="n">onConnectorChange</span> <span class="o">=</span> <span class="s1">&#39;connectorChange&#39;</span>
</span><span id="TYPES-64"><a href="#TYPES-64"><span class="linenos">64</span></a>    <span class="sd">&quot;&quot;&quot; When a connector is used in a slider functionality (connector) (Api 4.0+) &quot;&quot;&quot;</span>
</span><span id="TYPES-65"><a href="#TYPES-65"><span class="linenos">65</span></a>    <span class="n">onShutdown</span> <span class="o">=</span> <span class="s1">&#39;closePlugin&#39;</span>
</span><span id="TYPES-66"><a href="#TYPES-66"><span class="linenos">66</span></a>    <span class="sd">&quot;&quot;&quot; When Touch Portal tries to close your plug-in (Api 2.0+) &quot;&quot;&quot;</span>
</span><span id="TYPES-67"><a href="#TYPES-67"><span class="linenos">67</span></a>    <span class="n">onBroadcast</span> <span class="o">=</span> <span class="s1">&#39;broadcast&#39;</span>
</span><span id="TYPES-68"><a href="#TYPES-68"><span class="linenos">68</span></a>    <span class="sd">&quot;&quot;&quot; When Touch Portal broadcasts a message (Api 3.0+) &quot;&quot;&quot;</span>
</span><span id="TYPES-69"><a href="#TYPES-69"><span class="linenos">69</span></a>    <span class="n">onSettingUpdate</span> <span class="o">=</span> <span class="s1">&#39;settings&#39;</span>
</span><span id="TYPES-70"><a href="#TYPES-70"><span class="linenos">70</span></a>    <span class="sd">&quot;&quot;&quot; When the plugin&#39;s Settings have been updated (by user or from the plugin itself) (Api 3.0+) &quot;&quot;&quot;</span>
</span><span id="TYPES-71"><a href="#TYPES-71"><span class="linenos">71</span></a>    <span class="n">onNotificationOptionClicked</span> <span class="o">=</span> <span class="s2">&quot;notificationOptionClicked&quot;</span>
</span><span id="TYPES-72"><a href="#TYPES-72"><span class="linenos">72</span></a>    <span class="sd">&quot;&quot;&quot; When a user clicks on a notification action (Api 4.0+) &quot;&quot;&quot;</span>
</span><span id="TYPES-73"><a href="#TYPES-73"><span class="linenos">73</span></a>    <span class="n">shortConnectorIdNotification</span> <span class="o">=</span> <span class="s1">&#39;shortConnectorIdNotification&#39;</span>
</span><span id="TYPES-74"><a href="#TYPES-74"><span class="linenos">74</span></a>    <span class="sd">&quot;&quot;&quot; When creating new connector for the first time It will generate shortid and It will send as an event (Api 5.0+) &quot;&quot;&quot;</span>
</span><span id="TYPES-75"><a href="#TYPES-75"><span class="linenos">75</span></a>    <span class="n">allMessage</span> <span class="o">=</span> <span class="s1">&#39;any&#39;</span>
</span><span id="TYPES-76"><a href="#TYPES-76"><span class="linenos">76</span></a>    <span class="sd">&quot;&quot;&quot; Special event handler which will receive **all** messages from TouchPortal. &quot;&quot;&quot;</span>
</span><span id="TYPES-77"><a href="#TYPES-77"><span class="linenos">77</span></a>    <span class="n">onError</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span>
</span><span id="TYPES-78"><a href="#TYPES-78"><span class="linenos">78</span></a>    <span class="sd">&quot;&quot;&quot; Special event emitted when any other event callback raises an exception.</span>
</span><span id="TYPES-79"><a href="#TYPES-79"><span class="linenos">79</span></a><span class="sd">        For this particular event, the parameter passed to the callback handler will be an `Exception` object.</span>
</span><span id="TYPES-80"><a href="#TYPES-80"><span class="linenos">80</span></a><span class="sd">        See also `pyee.ExecutorEventEmitter.error` event.</span>
</span><span id="TYPES-81"><a href="#TYPES-81"><span class="linenos">81</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Event type enumerations. These correspond to the message types Touch Portal may send.
Event handler callbacks receive one parameter, which is the JSON data structure sent
from TP and then converted to a corresponding Python object using <code>json.loads()</code>.</p>

<h6 id="usage-example">Usage example</h6>

<blockquote>
  <div class="pdoc-code codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">TouchPortalAPI</span> <span class="k">as</span> <span class="nn">TP</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">TP</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="s2">&quot;myplugin&quot;</span><span class="p">)</span>

<span class="nd">@client</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">TP</span><span class="o">.</span><span class="n">TYPES</span><span class="o">.</span><span class="n">onConnect</span><span class="p">)</span>
<span class="c1"># equivalent to: @client.on(&#39;info&#39;)</span>
<span class="k">def</span> <span class="nf">onConnect</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># alternatively, w/out decorators:</span>
<span class="k">def</span> <span class="nf">onAction</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">client</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">TP</span><span class="o">.</span><span class="n">TYPES</span><span class="o">.</span><span class="n">onAction</span><span class="p">,</span> <span class="n">onAction</span><span class="p">)</span>
</code></pre></div>
</blockquote>
</div>


                            <div id="TYPES.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">TYPES</span><span class="signature pdoc-code condensed">()</span>

        
    </div>
    <a class="headerlink" href="#TYPES.__init__"></a>
    
    

                            </div>
                            <div id="TYPES.onHold_up" class="classattr">
                                <div class="attr variable">
            <span class="name">onHold_up</span><span class="default_value"> = &#39;up&#39;</span>

        
    </div>
    <a class="headerlink" href="#TYPES.onHold_up"></a>
    
            <div class="docstring"><p>When the action is used in a hold functionality and the user releases the Touch Portal button (Api 3.0+)</p>
</div>


                            </div>
                            <div id="TYPES.onHold_down" class="classattr">
                                <div class="attr variable">
            <span class="name">onHold_down</span><span class="default_value"> = &#39;down&#39;</span>

        
    </div>
    <a class="headerlink" href="#TYPES.onHold_down"></a>
    
            <div class="docstring"><p>When the action is used in a hold functionality and the user presses the Touch Portal button down (Api 3.0+)</p>
</div>


                            </div>
                            <div id="TYPES.onConnect" class="classattr">
                                <div class="attr variable">
            <span class="name">onConnect</span><span class="default_value"> = &#39;info&#39;</span>

        
    </div>
    <a class="headerlink" href="#TYPES.onConnect"></a>
    
            <div class="docstring"><p>Info message returned after successful pairing.</p>
</div>


                            </div>
                            <div id="TYPES.onAction" class="classattr">
                                <div class="attr variable">
            <span class="name">onAction</span><span class="default_value"> = &#39;action&#39;</span>

        
    </div>
    <a class="headerlink" href="#TYPES.onAction"></a>
    
            <div class="docstring"><p>When actions are triggered by the user (Api 1.0+)</p>
</div>


                            </div>
                            <div id="TYPES.onListChange" class="classattr">
                                <div class="attr variable">
            <span class="name">onListChange</span><span class="default_value"> = &#39;listChange&#39;</span>

        
    </div>
    <a class="headerlink" href="#TYPES.onListChange"></a>
    
            <div class="docstring"><p>When a user makes a change in one of your lists (Api 1.0+)</p>
</div>


                            </div>
                            <div id="TYPES.onConnectorChange" class="classattr">
                                <div class="attr variable">
            <span class="name">onConnectorChange</span><span class="default_value"> = &#39;connectorChange&#39;</span>

        
    </div>
    <a class="headerlink" href="#TYPES.onConnectorChange"></a>
    
            <div class="docstring"><p>When a connector is used in a slider functionality (connector) (Api 4.0+)</p>
</div>


                            </div>
                            <div id="TYPES.onShutdown" class="classattr">
                                <div class="attr variable">
            <span class="name">onShutdown</span><span class="default_value"> = &#39;closePlugin&#39;</span>

        
    </div>
    <a class="headerlink" href="#TYPES.onShutdown"></a>
    
            <div class="docstring"><p>When Touch Portal tries to close your plug-in (Api 2.0+)</p>
</div>


                            </div>
                            <div id="TYPES.onBroadcast" class="classattr">
                                <div class="attr variable">
            <span class="name">onBroadcast</span><span class="default_value"> = &#39;broadcast&#39;</span>

        
    </div>
    <a class="headerlink" href="#TYPES.onBroadcast"></a>
    
            <div class="docstring"><p>When Touch Portal broadcasts a message (Api 3.0+)</p>
</div>


                            </div>
                            <div id="TYPES.onSettingUpdate" class="classattr">
                                <div class="attr variable">
            <span class="name">onSettingUpdate</span><span class="default_value"> = &#39;settings&#39;</span>

        
    </div>
    <a class="headerlink" href="#TYPES.onSettingUpdate"></a>
    
            <div class="docstring"><p>When the plugin's Settings have been updated (by user or from the plugin itself) (Api 3.0+)</p>
</div>


                            </div>
                            <div id="TYPES.onNotificationOptionClicked" class="classattr">
                                <div class="attr variable">
            <span class="name">onNotificationOptionClicked</span><span class="default_value"> = &#39;notificationOptionClicked&#39;</span>

        
    </div>
    <a class="headerlink" href="#TYPES.onNotificationOptionClicked"></a>
    
            <div class="docstring"><p>When a user clicks on a notification action (Api 4.0+)</p>
</div>


                            </div>
                            <div id="TYPES.shortConnectorIdNotification" class="classattr">
                                <div class="attr variable">
            <span class="name">shortConnectorIdNotification</span><span class="default_value"> = &#39;shortConnectorIdNotification&#39;</span>

        
    </div>
    <a class="headerlink" href="#TYPES.shortConnectorIdNotification"></a>
    
            <div class="docstring"><p>When creating new connector for the first time It will generate shortid and It will send as an event (Api 5.0+)</p>
</div>


                            </div>
                            <div id="TYPES.allMessage" class="classattr">
                                <div class="attr variable">
            <span class="name">allMessage</span><span class="default_value"> = &#39;any&#39;</span>

        
    </div>
    <a class="headerlink" href="#TYPES.allMessage"></a>
    
            <div class="docstring"><p>Special event handler which will receive <strong>all</strong> messages from TouchPortal.</p>
</div>


                            </div>
                            <div id="TYPES.onError" class="classattr">
                                <div class="attr variable">
            <span class="name">onError</span><span class="default_value"> = &#39;error&#39;</span>

        
    </div>
    <a class="headerlink" href="#TYPES.onError"></a>
    
            <div class="docstring"><p>Special event emitted when any other event callback raises an exception.
For this particular event, the parameter passed to the callback handler will be an <code>Exception</code> object.
See also <code>pyee.ExecutorEventEmitter.error</code> event.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">${doc.signature}:</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value">${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>